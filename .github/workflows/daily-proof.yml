name: Daily Proof (Option C)

on:
  schedule: [{ cron: "12 1 * * *" }]  # 08:12 ICT daily
  workflow_dispatch:
    inputs:
      run_validation:
        description: 'Run full validation'
        required: false
        default: 'true'
  pull_request:
    paths:
      - 'docs/**'
      - '.github/workflows/daily-proof.yml'
      - 'g/reports/**'

permissions:
  contents: read

jobs:
  daily-proof:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Validate structure (Option C)
        run: |
          make validate-zones || echo "validate-zones not available, skipping"
          make proof || true

      - name: Upload latest proof
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: latest-proof
          path: g/reports/proof/*_proof.md
          if-no-files-found: warn
          retention-days: 30
