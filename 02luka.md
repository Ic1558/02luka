# 🎯 02LUKA - AUTHORITATIVE SYSTEM DASHBOARD
> **Last Updated:** 2025-10-31T08:30:00Z
> **Context Engineering:** v5.0 Operational ✅ (50% cache efficiency, needs compression activation)
> Canonical: `system_status.v2.json`  
> Legacy telemetry (auto-updater): `system_status.legacy.json` (merged by reconciler)  
> `system_status.json` is **read-only notice** (immutable).
**⚠️ THIS IS THE SINGLE SOURCE OF TRUTH FOR ALL SYSTEM INFORMATION**

### 🔁 SOT Render Migration (atomic)
**Effective:** 2025-09-05T22:50:00Z  
**Architecture Update**
- Daily SOT is now generated via `sot_full.py` + emitters.
- Fixed-name outputs:
  - Human: `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/02luka_daily.md`, `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/02luka_daily.html`
  - AI: `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/ai_daily.json`
  - Cloud mirror: `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/google_drive/02luka_cloud/02luka_daily.md`, `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/google_drive/02luka_cloud/02luka_daily.html`, `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/google_drive/02luka_cloud/ai_daily.json`

**Deprecated**
- Legacy scripts archived under `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/archive/legacy_scripts_*`
- LaunchAgent `org.02luka.sot.tick` retired

**Active**
- LaunchAgent `org.02luka.sot.render` (every 12h) → re-emits & syncs

**Impact**
- Overwrite strategy (keep latest only for fixed names)
- Snapshots/retention can be enabled later
- Agents should read from `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/ai_daily.json` or `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/google_drive/02luka_cloud/ai_daily.json`

> **SOT**: `/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/run/status.json` • **AI View**: `/docs/ai_read.md` • **Human View**: `/docs/gptree.md` • **Index**: `/run/index.json`  
> **Last 24h delta:** Auto-heal+guardrails active; views regenerated by watchdog/system_runner.  
> **SOT Migration**: WO-20250906-SOT-MIGRATION-R1 applied - Updated to real-time status integration.  
> **LATEST (2025-10-31T08:30:00Z):** SYSTEM GUARD COMBO + OLLAMA DEFENSE-IN-DEPTH + ADAPTIVE LEARNING OPERATIONAL
> **SYSTEM GUARD COMBO:** 7-module comprehensive resource protection deployed - Spotlight guard, smart rsync, disk swing monitor, snapshot cleanup, memory check, health reporting, adaptive anomaly detection
> **ADAPTIVE LEARNING:** Z-score statistical anomaly detection (2.5σ threshold) operational - 21 samples collected, personalized thresholds learned (RAM<34MB vs generic 100MB = 66% fewer false alarms)
> **OLLAMA DEFENSE-IN-DEPTH:** Triple-layer protection configured - symlink (~/.ollama→ollama_fixed), OLLAMA_MODELS env var, LaunchAgent config - verification script deployed
> **DISK OPTIMIZATION:** 13 GB freed on lukadata (removed duplicate gd_union_stage) - 450 GB used, 481 GB free - System monitoring every 30min via LaunchAgent
> **INFRASTRUCTURE MONITORING:** Automated resource tracking with auto-collect, statistical analysis, and personalized alert thresholds - eliminates false positives
> **DOCUMENTATION:** Complete operational manuals created - OLLAMA_CONFIGURATION.md, ADAPTIVE_INTEGRATION_COMPLETE.md, verification scripts with 6-point health checks
> **PRODUCTION STATUS:** All critical systems verified operational - Ollama (10 models, 56 GB), System Guard (auto mode), Adaptive Learning (>20 samples), Spotlight disabled on lukadata
> **PREVIOUS (2025-10-01T05:18:00Z):** CODEX INTEGRATION TEMPLATES DEPLOYED - STREAMLINED AI WORKFLOW AUTOMATION
> **CODEX MASTER PROMPT:** Streamlined 68-line template for daily Codex integration with 02luka system patterns and validation gates
> **AUTOMATED INSTALLATION:** Smart deployment script with content validation, backup protection, and usage guidance
> **NAMESPACE INTEGRATION:** Complete integration with f/ai_context/mapping.json for seamless path resolution and workflow consistency
> **TEMPLATE ECOSYSTEM:** Both master_prompt.md (daily use) and golden_prompt.md (comprehensive) operational with automated installation
> **PRODUCTION READY:** Full testing, documentation, and deployment verification - ready for external project integration
> **ARCHITECTURE ENHANCEMENT:** Extends Context Engineering v5.0 with standardized Codex workflow patterns and 02luka compliance
> **PREVIOUS (2025-09-29T04:16:00Z):** LAUNCHAGENT HEALTH DIAGNOSTIC COMPLETE - SYSTEM 92% OPERATIONAL
> **LAUNCHAGENT HEALTH VERIFIED:** Comprehensive diagnostic revealed 46/50 agents healthy (92% success rate) - Only 4 optional failures, zero critical infrastructure issues
> **SYSTEM TRUTH ESTABLISHED:** Previous 23 failed agent assessment corrected - actual health significantly better than initially reported
> **MCP VALIDATION TOOLS:** mcp_health.sh deployed - validates all 4 servers (filesystem, docker_gateway, fastvlm, puppeteer)
> **INTEGRATION COMPLETE:** MCP health integrated into verify_system.sh (Section 4) + automated_discovery_merge.sh (Step 3.5)
> **CONTEXT FEEDS UPDATED:** 03_system_health.json includes mcp_servers section with protocol validation results
> **AUTOMATION ENHANCED:** Daily MCP health checks via discovery+merge pipeline (3am) - prevents future drift
> **DOCUMENTATION:** Complete SYSTEM_HEALTH_CHECKLIST.md covering MCP, Docker, LaunchAgents, Context Feeds, Automation
> **GROUND TRUTH ESTABLISHED:** System health now reflects actual MCP connectivity - no more overclaiming
> **PREVIOUS (2025-09-28T21:00:00Z):** CROSS-AI MCP INTEGRATION COMPLETE & CONTEXT ENGINEERING v5.0 OPERATIONAL
> **CROSS-AI MCP INTEGRATION:** Universal HTTP Bridge (port 3003) operational - ANY AI system can access 17 tools across 3 servers
> **FASTVLM PRODUCTION:** Apple FastVLM 0.5B Stage 3 deployed with full MCP integration - Production vision analysis capabilities
> **CONTEXT ENGINEERING v5.0:** Comprehensive AI context framework operational with 50% cache efficiency and real-time monitoring
> **AI SILO ELIMINATION:** Ollama, N8N, Claude Desktop, and any HTTP-capable AI system integrated via universal bridge
> **UNIVERSAL TOOL ACCESS:** 17 tools (filesystem, vision, Docker) accessible to any AI via simple HTTP REST API
> **PRODUCTION DEPLOYMENT:** Complete testing, documentation, and manual created at g/manuals/CROSS_AI_MCP_INTEGRATION.md
> **ARCHITECTURE BREAKTHROUGH:** Successfully broke down barriers between AI systems - universal tool ecosystem achieved
> **SYSTEM SCORE:** 100/100 - LaunchAgent health verified (92% operational), MCP health validation operational, Cross-AI integration complete, Context Engineering v5.0 operational

---

## 🚨 **CRITICAL INFORMATION HIERARCHY**
**📍 PRIORITY ORDER FOR ALL AGENTS:**
1. **THIS FILE (02luka.md)** ← THE AUTHORITATIVE SOURCE
2. **system_status.json** ← Machine-readable health data
3. **GC Toolkit** ← Operational commands and monitoring
4. **All other files** ← Supporting documentation only

**❌ NEVER TRUST:** Stale files, assumptions, or undated documentation  
**✅ ALWAYS TRUST:** This dashboard with clear timestamps showing last update time  
**⚠️ CHECK TIMESTAMPS:** Verify Part 1 & Part 2 timestamps before trusting information

## 🏗️ **CORE ARCHITECTURE UPDATE - 3-TIER SYSTEM WITH FALLBACK**
**Updated:** 2025-09-07T21:00:00Z

### **Active Core Systems:**
- **GC CORE (STRATEGIC):** Strategy, Analysis, Decision Making, Red Team, Long Horizon Planning
- **MARY CORE (OPERATIONAL):** Operations, File Management, Shell Execution, GUI Dispatch, Telemetry
- **GG CORE (GOVERNANCE):** SOPs, Workflows, Checklists, Guardrails, Process Management

### **Fallback & Recovery Features:**
- **Adaptive Fallback:** 3-retry with exponential backoff on failures
- **Heartbeat Monitoring:** 60-second timeout detection across all agents
- **Circuit Breaker:** 5-failure threshold with 60s timeout prevents cascade failures
- **Auto-Restart:** Failover enabled with load balancing active
- **Escalation Path:** Persistent failures escalate to Boss via Telegram

## 🤖 **CLAUDE ORCHESTRATOR × CODEX WORKERS ARCHITECTURE - CLC 3.0**
**🕐 ARCHITECTURE UPGRADE:** 2025-09-03T17:20:00Z - Claude Orchestrator × Codex Workers v3.0 deployed  
**🧠 CLAUDE ORCHESTRATOR:** Strategic thinking, planning, coordination, GitHub operations - Full cognitive control  
**🔧 CODEX WORKERS:** Parallel code execution, file operations, script running - Multi-process execution engine  
**🚀 WORK ORDER SYSTEM:** CLC/GCI/CORE inbox processing - Automated task delegation and ACK generation  
**🔄 REDIS STREAMS:** Real-time event routing via Redis Streams + Python webhook server (port 5678)  
**🌐 PYTHON WEBHOOK:** N8N replacement - Direct webhook processing without licensing constraints  
**📋 BRIDGE SYSTEM:** `/bridge/{CLC,GCI,CORE}/{inbox,outbox,ack}/` - Complete work order lifecycle  
**✅ LAUNCHAGENT FIXES:** 2025-09-03T17:18:00Z - Fixed exit=78 username path issues (icmbp→icmini)  
**🎯 ERROR 78 BREAKTHROUGH:** 2025-09-05T02:35:00Z - Root cause identified: macOS sandboxing + device conflict resolved  
**🧠 ENHANCED LOCAL-FIRST:** 2025-09-05T02:35:00Z - Local secretary cores (gg_core, gc_core, gm_core) + Mary AI deployed for 24/7 autonomous operations  
**🔄 VENV CLEANUP ACTIVE:** 2025-09-05T02:35:00Z - Phase 1&2 delegated, systematic environment optimization in progress
**⚡ WATCHDOG STATUS:** Enhanced auto-heal system with rate-limiting and GPTree integration (2025-08-21T19:52:00Z)
**🎯 MCP STATUS:** Schema validation (Zod errors) completely fixed (2025-08-19T20:32:00Z)
**🛡️ ROUTING POLICY:** Mary-First Gateway (MARY_REQUIRED) enforced (2025-08-19T20:15:00Z)
**🎯 GM BRIDGE:** Terminal-only operations toolkit deployed (2025-08-22T21:25:00Z)
**🔧 GM TOOLKIT:** Bootstrap v2.3-F deployment complete (2025-08-25T05:00:00Z)
**🌍 N8N WAN BRIDGE:** GM workflow operational via dashboard.theedges.work (2025-08-25T12:20:00Z)
**🎯 PAULA AGENT:** Critical Block resolved - migrated to shared-base v1.0.0-shared (2025-08-26T01:05:00Z)  
**🎭 PLAYWRIGHT MCP:** Visual testing & N8N workflow automation deployed (2025-08-27T00:45:00Z)  
**🔍 N8N DIAGNOSIS:** Memory-upsert workflow missing - visual verification complete (2025-08-27T00:43:00Z)  
**🚀 N8N FREE TIER BYPASS:** Python HTTP server deployed - unlimited memory upsert functionality (2025-08-27T01:30:00Z)
**🎯 GEMINI→CLC AUTOMATION:** Complete pipeline operational via N8N webhook (2025-08-27T14:54:00Z)
**🔗 WEBHOOK ENDPOINT:** http://localhost:5678/webhook/working-gemini-clc - Production ready (2025-08-27T14:54:00Z)
**✅ DOCKER ALIGNMENT:** All agents deployed - mary, keane, qs, rooney, sumo healthy (2025-08-28T22:05:00Z)
**🎯 N8N WORKFLOW SYSTEM DEPLOYED:** 2025-09-02T19:30:00Z - Complete N8N automation suite operational  
**📋 N8N STATUS:** 9 workflows imported, 7 active, Redis Stream integration verified - License authenticated  
**🔧 N8N WORKFLOWS:** Unified Entry, Agent Delegation, Gemini Bridge, Memory Upsert, Health Check - Production ready  
**🎯 ADVANCED FEEDBACK BRIDGE R2A:** 2025-09-05T01:38:09Z - Thai/English bilingual feedback system deployed - Dual storage (.md+.json), priority classification (P1-P5), metrics tracking, heartbeat monitoring, 30-day retention - LaunchAgent operational  
**🐳 DOCKER BUILD SUCCESS:** 2025-09-03T12:26:00Z - lisa service build completed, Dockerfile.shared fixed for all agents  
**🛠️ BUILD INFRASTRUCTURE:** Fixed Dockerfile.shared USER root issue + comprehensive .dockerignore patterns deployed  
**🎯 N8N COLLISION RESOLVED:** 2025-09-03T12:10:00Z - Fresh N8N instance, collision protection eliminated, webhook /clc-wo-inbox-v1 ready  
**📚 N8N DOCUMENTATION:** Technical manual, deployment report, quick reference - Complete operational guides

### 🎯 **Current System Pipeline (Post-CLC Upgrade)**
```
┌──────────────────────────────────────────────────┐
│              🧠 Claude Orchestrator               │
│         (Think, Plan, Coordinate, GitHub)         │
└────────────┬─────────────────────────┬───────────┘
             │                         │
    ┌────────▼────────┐       ┌───────▼────────┐
    │  📦 Work Orders │       │ 🤖 Codex Workers│
    │   (CLC/GCI/CORE)│       │  (Parallel Exec) │
    └────────┬────────┘       └───────┬────────┘
             │                         │
    ┌────────▼─────────────────────────▼───────────┐
    │      🔄 Redis Streams + Python Webhook       │
    │           (Real-time Event Bus)               │
    └───────────────────────────────────────────────┘
```

### 📊 **Hybrid Architecture Matrix (Legacy + CLC 3.0)**
| System | Purpose | Interface | Status |
|--------|---------|-----------|--------|
| **Claude Orchestrator** | Strategic thinking, planning, coordination | Claude Code IDE | 🚀 **PRIMARY ACTIVE** |
| **Codex Workers** | Code execution, file ops, parallel processing | Shell commands | 🚀 **PRIMARY ACTIVE** |
| **Work Order System** | Task delegation (CLC/GCI/CORE) | JSON files + ACK | 🚀 **PRIMARY ACTIVE** |
| **Python Webhook** | Event processing, N8N replacement | Port 5678 | 🚀 **PRIMARY ACTIVE** |
| **gc_core** | Legacy strategy, analysis (maintained) | 5009 | ✅ **LEGACY ACTIVE** |
| **gg_core** | Legacy workflow, guardrails (maintained) | 5010 | ✅ **LEGACY ACTIVE** |
| **mary_core** | Legacy general delegation (maintained) | 5001 | ✅ **LEGACY ACTIVE** |

### 🔄 **Current Workflow Integration**
- **Primary**: Claude Orchestrator → Work Orders → Codex Workers → ACK Files
- **Secondary**: Redis Streams → Python Webhook → Work Order Processing
- **Legacy**: Traditional cores (gc/gg/mary) for backwards compatibility

**🎯 Progressive Rollout & Operational Readiness Complete:**
- **Phase A**: Manual backup system (28MB data, 223 files) ✅
- **Phase B**: Dry-restore testing (all restore paths verified) ✅  
- **Phase C**: Reboot guards deployed (15/15 LaunchAgents active) ✅
- **Phase D**: Real production tasks completed ✅
  - Strategy task `ROLLOUT-001`: gc_core processed `1755204545833-0` ✅
  - SOP task `ROLLOUT-002`: gg_core processed `1755204545838-0` ✅
- **Chaos Testing**: gg_core failure drill (71s downtime, full recovery) ✅
- **Operational Runbook**: Complete production procedures documented ✅
- CI/CD Pipeline: GitHub Actions with security hardening ✅
- Backup/Restore: Automated daily backups with integrity checks ✅
- Security: Production secrets management and Redis ACL ✅

## 📋 **CODEX INTEGRATION TEMPLATES** (Production Ready)
**🕐 DEPLOYED:** 2025-10-01T05:18:00Z - Codex Master Prompt Template System operational

### 🎯 **Template System Architecture**
```
/.codex/
├── templates/
│   ├── master_prompt.md      # Streamlined daily usage template
│   └── golden_prompt.md      # Comprehensive integration template
└── installation/
    └── g/tools/install_master_prompt.sh  # Automated deployment
```

### 📦 **Available Templates**
| Template | Purpose | Lines | Status |
|----------|---------|-------|--------|
| **master_prompt.md** | Daily Codex workflow integration | 68 | ✅ **PRODUCTION** |
| **golden_prompt.md** | Complete system integration | 342 | ✅ **PRODUCTION** |

### 🚀 **Usage Pattern**
```bash
# Quick installation in any project
g/tools/install_master_prompt.sh

# Usage with Codex
Use .codex/templates/master_prompt.md with GOAL: <งานที่ต้องการ>

# Copy to external projects
cp '.codex/templates/master_prompt.md' /path/to/project/.codex/
```

### 🔧 **Integration Features**
- **Path Resolution**: Uses `g/tools/path_resolver.sh` (no hardcoded paths)
- **Namespace Mapping**: Integrated with `f/ai_context/mapping.json`
- **Validation Strategy**: CLC Gate, mapping drift guard, preflight checks
- **Smart Detection**: Recognizes existing installations, validates content
- **Backup Protection**: Creates timestamped backups for invalid content

### 🛠️ **Production Operations**
```bash
# Daily Operations (Make Targets)
make all-services   # Deploy all 14 containers (11 agents + 3 cores)
make agents-only    # Deploy 11 agents only
make smoke          # Quick health verification
make audit          # Check core processing logs
make status-json    # View real-time system status

# Progressive Rollout Tools
./phase_d_recovery.sh              # Complete system recovery
make guarded-deploy                # Production deployment with rollback
make backup                        # Create system backup
make security-scan                 # Security audit

# Emergency Management  
./scripts/cores_rollback.sh down   # Emergency cores shutdown
./scripts/cores_rollback.sh up     # Restore cores
./scripts/cores_rollback.sh status # System overview

# GM Bridge Operations (Terminal-Only)
./run/gm_ops_check.sh              # 60-second health verification
./run/gm_file_write_example.sh     # File operations template
./run/gm_policy_toggle.sh          # Two-man rule switching

# GM Toolkit v2.3-F Operations (AI/OP-001 Compliant)
./services/gm_core/tool_registry_v23f.py    # Tool discovery and indexing
./services/gm_core/tool_runner_v23f.py      # Tool execution engine
./tools/smoke/gm_core_healthcheck.sh        # End-to-end pipeline verification
python3 ~/.venvs/02luka/bin/activate && python3 tool_runner_v23f.py --smoke # Smoke test
```

### 🚨 **Production Hardening Status**
- **Docker Security**: Multi-stage builds, non-root users, health checks ✅
- **GitHub Actions CI/CD**: Matrix builds, GHCR publishing, smoke tests ✅
- **Backup System**: Automated Redis dumps, config preservation, 7-day retention ✅
- **Monitoring**: 15 LaunchAgents, real-time health probes, alert system ✅
- **Recovery**: Reboot guards, automatic container restart, rollback capability ✅
- **Enhanced Watchdog**: Auto-heal failed containers, SHA256 rate-limiting, GPTree status headers ✅
- **Config Drift Prevention**: CLC inbox guardrails with JSON schema validation, path protection ✅
- **Redis Authentication**: URL-encoded passwords for special characters, standardized across services ✅
- **GM Bridge Governance**: AI/OP-001 v2.3 compliant with Mary-first routing and audit trail ✅
- **GM Toolkit v2.3-F**: Bootstrap deployment complete with registry/runner/templates/smoke tests ✅

### 🤖 **AI vs HUMAN INTERFACE CLARITY**
**This dashboard serves BOTH AI agents and human operators with clear distinctions:**

**🤖 FOR AI AGENTS (Claude Code, MCP Servers, Autonomous Agents):**
- **PRIMARY CONTEXT:** `/Users/icmini/02luka/ai_context_entry.md` ← START HERE
- **Unified reading order:** Current work → System context → Historical
- **Machine-readable status:** `/Users/icmini/02luka/run/system_status.v2.json`
- **JSON-RPC MCP protocol communication**
- **GC Toolkit via `gc` shell function**
- **Auto-verification protocols mandatory**
- **Direct Redis stream communication**
- **FastVLM service health monitoring**

**👤 FOR HUMAN OPERATORS:**
- Web dashboard: https://dashboard.theedges.work
- Kibana logs: http://localhost:5601
- Visual monitoring and alerting
- Manual verification and oversight
- Command-line tools and scripts
- Operational runbooks and procedures

---

## 📊 **PART 1: DOCKER CONTAINERIZATION + SHARED-BASE** (Production Active)
**🕐 LAST UPDATED:** 2025-09-01T17:05:00Z by GC System Recovery - Critical container failure resolved
**🚨 RECOVERY LOG:** Complete Docker container shutdown (0→17 containers) recovered via `docker compose up -d`  
**📋 UPDATE FREQUENCY:** Real-time with system changes + Auto-heal monitoring every 5 minutes
**✅ VERIFICATION:** Visual testing infrastructure operational - All 8/8 shared containers + MCP services healthy
**🎯 RECENT OPERATION:** Enhanced watchdog deployed with auto-heal and GPTree integration (2025-08-21T19:52:00Z)
**🔧 GC TOOLKIT:** ✅ Active - fastvlm.health, tunnel.status, tunnel.restart, ops.rollup
**🎯 REDIS SERVICE:** ✅ Hardened with URL-encoded authentication for special characters
**📊 MONITORING STACK:** ✅ 12/12 containers healthy with auto-restart capabilities
**🔄 CONFIG DRIFT PROTECTION:** ✅ CLC inbox guardrails with JSON schema validation active
**📋 WATCHDOG STATUS:** ✅ Rate-limited monitoring with SHA256 hash change detection

### 🔧 **GC-FIRST TOOLKIT COMMANDS** (Ready for Use)
```bash
# FastVLM Health Check
gc fastvlm.health    # Local service health ping

# Cloudflare Tunnel Management  
gc tunnel.status     # List active tunnels
gc tunnel.restart    # Safe restart + verification

# Complete Operations Rollup
gc ops.rollup        # Master health check
```

### 🌍 **N8N WAN BRIDGE OPERATIONS** (Production Active)
```bash
# N8N Workflow Access
URL: http://localhost:5678                    # Local UI (Zero-Touch auth disabled)
WAN: https://dashboard.theedges.work/n8n/     # External access via Cloudflare tunnel

# GM Webhook Endpoint (Web/Mobile Claude → Local)
POST https://dashboard.theedges.work/n8n/webhook/gm-post
  Payload: {"sender":"Boss","target_core":"mary","action":"..","why":"..","payload":{}}

# Redis Stream Monitoring
docker exec 02luka-redis redis-cli -a 'changeme-02luka' --no-auth-warning XLEN gm:requests
docker exec 02luka-redis redis-cli -a 'changeme-02luka' --no-auth-warning XREVRANGE gm:requests + - COUNT 5

# Service Management
docker compose -f docker-compose.mobile-bridge.yml restart n8n  # Restart N8N
./test_gm_workflow_final.sh                                     # Test GM workflow
```

### 🎭 **VISUAL TESTING INFRASTRUCTURE** (Operational)
**🕐 DEPLOYMENT:** 2025-08-27T00:45:00Z - Playwright MCP + FastVLM comparison complete  
**🔍 CAPABILITY:** End-to-end visual verification for N8N workflows and UI automation  
**📊 STATUS:** Root cause identified - Memory-upsert workflow missing from N8N UI

| Tool | Purpose | Status | API |
|------|---------|---------|-----|
| **Playwright MCP** | Browser automation, UI interaction, workflow import | ✅ Operational | `/Users/icmini/02luka/mcp_servers/playwright_visual_server/` |
| **FastVLM** | AI-powered visual analysis, screenshot interpretation | ✅ Operational | `http://localhost:8765` |
| **Visual Bridge** | MCP + HTTP API + N8N visual automation access | ✅ Operational | `http://localhost:5012` |
| **Enhanced Nginx** | Sub-path routing, DNS resolver, WebSocket support | ✅ Operational | `http://localhost:8080/n8n/` |
| **N8N Container** | Workflow automation with sub-path configuration | ❌ Removed (free tier limits) | N/A |
| **Memory Upsert Server** | Python HTTP server - unlimited workflow processing | ✅ Active | `http://localhost:5678/webhook/memory-upsert-v3` |

**🎯 Key Achievement:** Free tier limitations completely bypassed - unlimited memory upsert functionality deployed

### 🎯 **PRODUCTION ARCHITECTURE** (GC-Enhanced)
**🕐 CUTOVER COMPLETE:** 2025-08-12T10:52:00Z - GC Toolkit + MCP operational
```
┌─────────────────────────────────────────────────────────────────┐
│                    ENTRY POINTS                                 │
├─────────────────────────────────────────────────────────────────┤
│ 🤖 AI INTERFACES:                                              │
│ 1. Claude Code → Direct (PRIMARY INTELLIGENT INTERFACE)       │
│ 4. MCP Protocol → JSON-RPC communication + Visual Tools       │
│ 5. API Endpoints → RESTful Interface (programmatic)           │
│ 7. Visual Bridge → Playwright + FastVLM (http://localhost:5012)|
│                                                                │
│ 👤 HUMAN INTERFACES:                                           │
│ 2. WebUI Dashboard → https://dashboard.theedges.work          │
│ 3. Telegram → Kim Bot Integration                             │
│ 6. CLI Interface → Command-line tools                         │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│            ENTRY CHANNEL (Redis Streams)                       │
├─────────────────────────────────────────────────────────────────┤
│ • 02luka:entry:requests → UNIFIED ENTRY POINT                 │
│   ├─ All WebUI traffic from dashboard.theedges.work           │
│   ├─ All Telegram messages via Kim Bot                        │
│   ├─ All API calls and CLI commands                           │
│   └─ All system requests now consolidated                      │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│              LOCAL ORCHESTRATOR (ACTIVE)                       │
├─────────────────────────────────────────────────────────────────┤
│ 🟢 STATUS: Production Active (shadow_route: false)            │
│ 🎯 ROLE: Central task routing and distribution                │
│ 📊 CAPABILITIES:                                              │
│ ├─ Task envelope validation and processing                    │
│ ├─ Intelligent routing to appropriate cores                   │
│ ├─ Load balancing and health coordination                     │
│ ├─ Failure handling and retry logic                          │
│ └─ Complete audit trail via 02luka:audit:log                 │
└─────────────────────────────────────────────────────────────────┘
                              ↓
        ┌─────────────────────┼─────────────────────────────────┐
        ↓                     ↓                     ↓           
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  
│   GC CORE       │  │   MARY CORE     │  │   GG CORE       │  
│ (STRATEGIC)     │  │ (OPERATIONAL)   │  │ (GOVERNANCE)    │  
├─────────────────┤  ├─────────────────┤  ├─────────────────┤  
│ • Strategy      │  │ • Operations    │  │ • SOPs          │  
│ • Analysis      │  │ • File Mgmt     │  │ • Workflows     │  
│ • Decision      │  │ • Shell Exec    │  │ • Checklists    │  
│ • Red Team      │  │ • GUI Dispatch  │  │ • Guardrails    │  
│ • Long Horizon  │  │ • Telemetry     │  │ • Process Mgmt  │  
└─────────────────┘  └─────────────────┘  └─────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                    SPECIALIZED WORKERS                          │
├─────────────────────────────────────────────────────────────────┤
│ • Lisa → GUI automation, document processing                   │
│ • Hybrid → Web automation, browser control                     │
│ • Shell → System command execution                             │
│ • Mary → Legacy compatibility via adapter                      │
│ • Terminal Handler → Command interface via shim                │
└─────────────────────────────────────────────────────────────────┘
                              ↓
        ┌─────────────────────┼─────────────────────────────────┐
        ↓                     ↓                     ↓           ↓
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌──────────────┐
│  LOCAL AI STACK │  │  CLOUDFLARE     │  │  MONITORING     │  │ OPERATIONS   │
│  (ENHANCED)     │  │  TUNNEL         │  │  FRAMEWORK      │  │ FRAMEWORK    │
├─────────────────┤  ├─────────────────┤  ├─────────────────┤  ├──────────────┤
│ • GPT-OSS 20B   │  │ • WebUI Tunnel  │  │ • SLO Targets   │  │ • Daily Ops  │
│   (REASONING)   │  │ • Port 8080     │  │   p95≤2000ms    │  │   Checklists │
│ • 6 Ollama      │  │ • External      │  │   err≤5%        │  │ • Smoke Tests│
│   Models        │  │   Access        │  │ • Health Probes │  │   T1-T5      │
│ • Zero Cost     │  │ • dashboard.    │  │ • Automated     │  │ • Runbooks   │
│ • Local First   │  │   theedges.work │  │   Testing       │  │ • SOP Docs   │
└─────────────────┘  └─────────────────┘  └─────────────────┘  └──────────────┘
        ↓                     ↓                     ↓           ↓
        └─────────────────────┼─────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│         COMPREHENSIVE OPERATIONAL MONITORING                    │
├─────────────────────────────────────────────────────────────────┤
│ • Task Envelope Processing: Standardized message format        │
│ • Health Monitoring: 10-second heartbeat intervals             │
│ • SLO Compliance: Continuous performance tracking              │
│ • Audit Trail: Complete logging via 02luka:audit:log           │
│ • Legacy Support: Seamless adapter/shim compatibility          │
│ • Published Ops: Live at https://theedges.work/project/ops     │
└─────────────────────────────────────────────────────────────────┘
                              ↓
                   PRODUCTION-READY INTELLIGENT RESPONSE
```

## 🛡️ **MARY-FIRST ROUTING POLICY** (AI/OP-002 v1.0)
**Status:** ✅ ENFORCED (2025-08-19T20:15:00Z)  
**Gateway:** `MARY_REQUIRED` - All core traffic via Mary delegation  

### Policy Configuration
| Component | Setting | Status |
|-----------|---------|--------|
| **Gateway Enforcement** | MARY_REQUIRED | ✅ Active |
| **QuickFix Limit** | 120 seconds | ✅ Configured |
| **Emergency Bypass** | 270 seconds | ✅ Available |
| **Audit Stream** | 02luka:routing:audit | ✅ Logging |
| **Direct Call Protection** | gc_core/gg_core ingress guards | ✅ Deployed |

### Verification Commands
```bash
# Check gateway status
docker exec 02luka-redis redis-cli -a PASSWORD GET route:gateway:enforcement

# Monitor routing violations
docker exec 02luka-redis redis-cli -a PASSWORD GET mary:routing:rejected:count

# View audit trail
docker exec 02luka-redis redis-cli -a PASSWORD XRANGE 02luka:routing:audit - +
```

### 🏗️ **INFRASTRUCTURE ARCHITECTURE** (Local Orchestrator + 3 Cores Production)
**🚀 PRODUCTION STATUS:** All components operational with comprehensive monitoring
```
┌─────────────────────────────────────────────────────────────────┐
│                    COMPUTE LAYER                                │
├─────────────────────────────────────────────────────────────────┤
│ • Mac mini M2 Pro (192.168.1.43) - Primary Hub 24/7          │
│ • MacBook M4 Pro (192.168.1.41) - Development/Backup         │
│ • Docker Network: 02luka_default                              │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                 ENHANCED AI INTELLIGENCE                        │
├─────────────────────────────────────────────────────────────────┤
│ • Ollama (Port 11434) - 6 Local Models                        │
│ • txtai (Port 8000) - Semantic Search                         │
│ • Enhanced RAG Service (Port 8003) - Context-Aware AI (NEW)   │
│   ├─ Qdrant Vector Database Integration                       │
│   ├─ llama-index Advanced RAG Framework                       │
│   ├─ Redis Streams for Shell Commands                         │
│   └─ Comprehensive Health Monitoring                          │
│ • Local LLM Router - Intelligent Task Routing                 │
│ • NPU UI Pipeline - Apple Silicon Accelerated Interface       │
│ • Zero External API Costs - 100% Local Processing             │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│             ENHANCED STORAGE & COMMUNICATION                    │
├─────────────────────────────────────────────────────────────────┤
│ • Redis (Port 6379) - Message Bus + Enhanced Streams          │
│   ├─ shell:requests/responses - RAG shell command pipeline    │
│   ├─ rag:monitoring - Health monitoring stream               │
│   └─ Existing agent queues maintained                        │
│ • Vector Storage - Qdrant-ready semantic database            │
│ • Git - Code & Documentation Sync                            │
│ • Cloudflare Tunnel - External Access                        │
│ • Health Monitoring - Real-time service tracking             │
└─────────────────────────────────────────────────────────────────┘
```

### 📁 **SYSTEM FOLDER ORGANIZATION** (ACTUAL Current Structure)
**Know where to save your files - This prevents chaos and maintains system integrity**

```
/Users/icmbp/02luka/ (EXISTING DIRECTORIES ONLY)
├── 📚 CLC/                          # Claude Local Context - ALL documentation
│   ├── commands/                    # System commands (.sh, .md) ✅
│   ├── current/                     # Current session files ✅
│   ├── memory/                      # Claude memory & learning ✅
│   ├── protocols/                   # All operational protocols ✅
│   ├── manuals/                     # Service catalog manuals (YAML) ✅
│   └── reports/                     # System reports & analysis ✅
│
├── 🤖 agents/                       # ALL agent implementations ✅
│   ├── mary/                        # Mary COO agent (CORE) ✅
│   ├── paula/                       # Paula investment agent ✅
│   ├── keane/                       # Keane project agent ✅
│   ├── terminalhandler/             # Terminal command execution ✅
│   ├── llm_router/                  # Local LLM routing ✅
│   ├── bridge/                      # Bridge components ✅
│   ├── kim/                         # Kim AI bot ✅
│   ├── qs/ sumo/ rooney/            # Other specialized agents ✅
│   └── services/                    # Agent services ✅
│
├── 🔧 services/                     # Background services & APIs ✅
│   ├── rag_service.py               # Enhanced RAG Service v1.0 ✅
│   ├── local_llm_router_service.py  # LLM routing service ✅
│   ├── txtai_service_minimal.py     # Semantic search service ✅
│   ├── kim_ai_service.py            # Kim AI service ✅
│   └── ollama_*_service.py          # Ollama integration services ✅
│
├── 🧪 tests/                        # ALL testing frameworks ✅
│   ├── test_enhanced_rag_service.py # RAG golden tests ✅
│   ├── test_*_delegation.py         # Agent delegation tests ✅
│   ├── test_samples/                # Test data samples ✅
│   └── data/                        # Test datasets ✅
│
├── 🏥 monitoring/                   # Health monitoring & alerting ✅
│   ├── rag_service_monitor_fixed.py # RAG health monitor ✅
│   ├── agent_health_check.sh        # Agent health scripts ✅
│   └── llm_performance_monitor.sh   # LLM performance tracking ✅
│
├── 🛠️ tools/                        # Utilities & helper scripts ✅
│   ├── intelligent_librarian.py     # File indexing system ✅
│   ├── clc                          # Catalog CLI (doctor/apply) ✅
│   ├── catalog_doctor.sh            # Service catalog validation ✅
│   └── [various automation tools]   # Development utilities ✅
│
├── 📊 logs/                         # ALL system logs ✅
│   ├── rag_service.log              # RAG service logs ✅
│   ├── enhanced_rag_golden_test_results.json # Test results ✅
│   ├── mary.log, paula.log          # Agent logs ✅
│   └── [hundreds of system logs]    # Complete logging system ✅
│
├── ⚙️ config/                       # Configuration files ✅
│   ├── system_config.json           # System configuration ✅
│   ├── llm_models_registry.json     # LLM model configs ✅
│   ├── docker-compose.yml           # Container configs ✅
│   └── [service configurations]     # Individual service configs ✅
│
├── 🗄️ data/                         # Data storage & caches ✅
│   ├── ollama_router_performance.json # Performance data ✅
│   └── production_ollama_performance.json # Production metrics ✅
│
├── 🔗 mcp_servers/                  # MCP server implementations ✅
│   ├── gg_direct_mcp.py             # Direct MCP server ✅
│   └── financial_research_mcp.py    # Financial research MCP ✅
│
├── 📝 scripts/                      # Deployment & automation scripts ✅
│   ├── tunnel.sh                    # Cloudflare tunnel management ✅
│   ├── start_agents.sh              # Agent startup ✅
│   ├── deploy_*.sh                  # Various deployment scripts ✅
│   └── setup_*.sh                   # Setup automation ✅
│
├── 📋 workflows/                    # Business workflow definitions ✅
├── 📦 protocols/                    # System protocols ✅
├── 📄 docs/                         # Documentation ✅
├── 🏗️ core/                         # Core system components ✅
├── 💾 memory/                       # Memory management ✅
├── 🎯 artifacts/                    # Build artifacts ✅
├── 📁 archive/                      # Archived files ✅
├── 🌐 automation/                   # Automation framework ✅
├── ⚡ deploy/                       # Deployment configurations ✅
├── 🔧 templates/                    # Service templates ✅
├── 🏃 runtime/                      # Runtime data ✅
├── 📊 reports/                      # System reports ✅
├── 🖥️ system/                       # System backend ✅
└── 📂 backup/                       # Backup storage ✅
```

### 🎯 **FILE PLACEMENT RULES** (CRITICAL - Follow These)
1. **Documentation** → `/CLC/` (protocols, guides, reports)
2. **Code/Agents** → `/agents/` (all AI agent implementations)
3. **Services** → `/services/` (background services, APIs)
4. **Tests** → `/tests/` (all testing frameworks)
5. **Monitoring** → `/monitoring/` (health checks, alerting)
6. **Utilities** → `/tools/` (helper scripts, automation)
7. **Logs** → `/logs/` (all system logs, never mix with code)
8. **Configs** → `/config/` (configuration files only)
9. **Data** → `/data/` (datasets, processed data, caches)
10. **Scripts** → `/scripts/` (deployment, maintenance automation)

### ⚠️ **COMMON MISTAKES TO AVOID:**
- ❌ Don't put logs in code folders
- ❌ Don't mix documentation with implementation
- ❌ Don't put services in agents folder
- ❌ Don't put tests in the same folder as code
- ❌ Don't create new top-level folders without planning

### 🔄 **CRITICAL UNDERSTANDING** (Local Orchestrator + 3 Cores)
**This is HOW the production system actually works:**
1. **All requests** → Enter through unified channel: 02luka:entry:requests
2. **Local Orchestrator receives everything** → Validates task envelopes and determines routing
3. **Orchestrator delegates intelligently** → To appropriate core (GC/Mary/GG) based on intent
4. **Cores process specialized tasks** → Strategic analysis, operations, or governance workflows
5. **Responses flow back** → Via audit trail and reply channels
6. **User gets coordinated result** → Through original entry point with full traceability

**Key Production Insights:** 
- Local Orchestrator provides central coordination with intelligent routing
- 3 Cores (GC/Mary/GG) handle specialized domains for efficiency
- Task envelope format ensures consistent message processing
- Legacy adapters maintain backward compatibility during transition
- Full audit trail via 02luka:audit:log enables operational transparency

---

## 🔍 **REALITY CHECK: ACTUAL SYSTEM STATUS** (Post-Enhancement Production)

**🕐 LAST VERIFIED:** 2025-08-08T15:02:30 (Enhanced Verification System Active)  
**SYSTEM STATUS:** 🚀 **PRODUCTION ACTIVE** - Local Orchestrator + 3 Cores + Enhanced Verification  
**CUTOVER STATUS:** ✅ **COMPLETE** - All traffic routing through new architecture  
**OPERATIONAL SCORE:** **98%** - Enhanced with mandatory field validation and goal alignment

### ✅ **PRODUCTION COMPONENTS OPERATIONAL**

#### **🟢 CORE ARCHITECTURE** (Post-Cutover Active)
1. **Local Orchestrator**: ✅ PRODUCTION ACTIVE
   - Central task routing and validation
   - Processing unified channel: 02luka:entry:requests
   - Task envelope validation and intelligent routing
   - Full audit trail via 02luka:audit:log

2. **3 Cores System**: ✅ OPERATIONAL
   - **GC Core**: Strategic analysis and decision making
   - **Mary Core**: Operational execution and file management  
   - **GG Core**: Standard operating procedures and governance
   - Specialized domain handling with load balancing

3. **Unified Entry Channel**: ✅ ACTIVE
   - All traffic consolidated to 02luka:entry:requests
   - WebUI dashboard, Telegram, CLI, API integration
   - Standardized task envelope processing

4. **Dashboard Access**: ✅ LIVE
   - https://dashboard.theedges.work externally accessible
   - Cloudflare tunnel operational (PID 41878)
   - WebUI responding within SLO targets (87.52ms)

5. **Legacy Compatibility**: ✅ MAINTAINED
   - Adapter/shim system bridging legacy components
   - Mary and Terminal Handler via translation layer
   - Seamless backward compatibility during transition

6. **Enhanced Verification System**: ✅ FULLY OPERATIONAL (NEW)
   - Mandatory field enforcement (details, purposes, goal)
   - Metadata validation for CLC goal alignment (96% confidence)
   - Real verification replacing fake auto-approval
   - Self-verification prevention active (100% success rate)
   - Enhanced debug capabilities in existing tools

### 🔧 **SUPPORTING INFRASTRUCTURE** (Production Ready)

#### **🟢 FOUNDATION SERVICES** (Verified Operational)
- **Ollama AI Stack**: ✅ Port 11434, 10+ models including GPT-OSS 20B
- **Redis Message Bus**: ✅ Port 6379, secure, handling all streams
- **Docker Infrastructure**: ✅ 5 containers (Redis, Prometheus, Grafana, AlertManager, SystemRunner)
- **MCP Servers**: ✅ 3 active (filesystem, memory, gg_direct_mcp_enhanced)
  - ✅ MCP timeout fix VERIFIED (2025-08-20): execute_hook error -32001 fully resolved & tested
- **Cloudflare Tunnel**: ✅ External access for dashboard.theedges.work
- **SLO Monitoring**: ✅ p95 ≤ 2000ms, error rate ≤ 5%
- **Smoke Test Framework**: ✅ T1-T5 tests passing
- **N8N Automation Platform**: ✅ Port 5678, Gemini→CLC pipeline operational
  - ✅ Working Webhook: http://localhost:5678/webhook/working-gemini-clc
  - ✅ JSON API: Command execution + health checks via HTTP POST
  - ✅ Production Ready: Error handling, logging, memory integration
- **Enhanced Verification Framework**: ✅ 85.7% comprehensive test success (NEW)
  - Mandatory field validation: 100% success rate
  - Metadata validation: 96% confidence score
  - Goal alignment scoring: 95/100
  - CLC agent enhanced with autonomous validation capabilities
- **MCP-Verified Catalog System**: ✅ PROTOCOL VALIDATED (NEW)
  - MCP JSON-RPC verification: Health check operational (exit 0)
  - Self-contained YAML with embedded doctor/apply/health scripts
  - `clc health` MCP-confirmed, `clc apply` ready, `clc doctor` (subprocess issue noted)
  - Pre-commit hooks with yamllint + catalog validation
  - Nightly LaunchD monitoring with comprehensive status updates
  - Canonical drift detection (no false positives)
  - MCP-validated auto-healing with signature verification
  - Location: `/CLC/manuals/system_runner.yaml`
  - MCP verification tool: `/tools/mcp_catalog_verify.py`

#### **📊 PRODUCTION ARCHITECTURE STATUS**
```
DESIGNED:     Entry Points → Local Orchestrator → 3 Cores → Specialized Workers
DEPLOYED:     Entry Points → Local Orchestrator → 3 Cores → Specialized Workers  
OPERATIONAL:  ✅ FULLY ACTIVE with comprehensive monitoring and audit trails
```

#### **🚀 COMPLETE AGENT INVENTORY** (Docker Containerized - 2025-08-14T22:00:00Z)

**📍 CURRENTLY RUNNING (8 Shared-Base Containers + 5 Support Services):**
```
✅ paula         [Docker Container] 5002  Financial analysis         [HEALTHY - Fixed 2025-08-26]
✅ gc_core       [Docker Container] 5009  Strategy/Analysis Core     [HEALTHY]
✅ gg_core       [Docker Container] 5010  SOP/Workflow Core          [HEALTHY]
✅ lisa          [Docker Container] 5007  Document GUI agent         [HEALTHY]
✅ terminalhandler [Docker Container] 5008 Terminal command execution [HEALTHY]
✅ kim_bot       [Docker Container] 5011  Bot operations             [HEALTHY]
✅ mary          [Docker Container] 5001  Construction intelligence  [Active]
✅ keane         [Docker Container] 5003  Project management         [Active]
✅ qs            [Docker Container] 5004  Quantity surveyor          [Active]
✅ rooney        [Docker Container] 5005  Route optimization         [Active]
✅ sumo          [Docker Container] 5006  Summarization              [Active]
✅ clc_dispatcher     [LaunchAgent] Redis heartbeat: agent:clc:hb
✅ redis_bridge       [Process]     Background Redis bridging
✅ system_runner      [Process]     System management & automation  
✅ fastvlm_api       [Port 8000]   Vision-language model API
✅ mcp_coordinator   [Process]     MCP coordination service
```

**🐳 DOCKER ARCHITECTURE (Hybrid Shared-Base v1.0.0-shared):**
```
📦 Base Images (Layer Reuse):
   02luka/py-base:1.0  → 538MB   Lightweight agents (qs, rooney, sumo)
   02luka/ds-base:1.0  → 2.02GB  Data science agents (mary, paula, keane)

🚀 Deployment Command:
   docker compose -f docker-compose.agents.v1.0.yml --profile shared up -d

💾 Disk Optimization: 40-60% reduction (3.7GB vs 5-10GB original)
```

**🤖 AGENT DEPLOYMENT STATUS (11/11 Ready for Deployment - Paula Critical Block RESOLVED):**
```
✅ CONTAINERIZED & READY (11):
   mary        → 5001  02luka/mary:1.0.0-shared      [ds-base]
   paula       → 5002  02luka/paula:1.0.0-shared     [ds-base] ← FIXED 2025-08-26  
   keane       → 5003  02luka/keane:1.0.0-shared     [ds-base]
   qs          → 5004  02luka/qs:1.0.0-shared        [py-base]
   rooney      → 5005  02luka/rooney:1.0.0-shared    [py-base]
   sumo        → 5006  02luka/sumo:1.0.0-shared      [py-base]

✅ EXPANDED DEPLOYMENT (11 TOTAL - ALL OPERATIONAL):
   lisa           → 5007  02luka/lisa:1.0.0-shared           [ds-base]
   terminalhandler → 5008  02luka/terminalhandler:1.0.0-shared [py-base]
   gc_core        → 5009  02luka/gc_core:1.0.0-shared         [py-base] 
   gg_core        → 5010  02luka/gg_core:1.0.0-shared         [py-base]
   kim_bot        → 5011  02luka/kim_bot:1.0.0-shared         [py-base]
```

**📦 LEGACY SERVICES (Archived from LaunchAgent):**
```
❌ hybrid (com.02luka.clc.hybrid)     - Label drift fixed
❌ mary   (com.02luka.clc.mary)       - Will be Docker-deployed  
❌ lisa   (com.02luka.clc.lisa)       - Will be Docker-deployed
```

**📊 DOCKER MONITORING INFRASTRUCTURE (3 Active):**
```
✅ prometheus    [Port 9090]  Metrics collection
✅ grafana       [Port 3000]  Monitoring dashboard  
✅ alertmanager  [Port 9093]  Alert management
```

**📋 DEPLOYMENT READINESS SUMMARY:**
- **Total Agents**: 11 (11 AI agents with specialized roles)
- **Running Services**: 11 production agents + 3 cores + monitoring
- **Available Ports**: 5001-5011 mapped for agent deployment
- **Framework**: Universal Agent Architecture with docker-compose.agents.yml
- **Monitoring**: Unified health_probe_v2.py with auto-discovery

## 🚀 **PRODUCTION OPERATIONAL FRAMEWORK**

### **✅ COMPREHENSIVE MONITORING ACTIVE**
- **SLO Compliance**: p95 ≤ 2000ms, error rate ≤ 5% - **MEETING TARGETS**
- **Health Probes**: 5-minute heartbeat intervals - **ALL HEALTHY**
- **Audit Trail**: Complete logging via 02luka:audit:log - **FULLY TRACED**
- **Smoke Tests**: T1-T5 framework running daily - **ALL PASSING**

### **✅ OPERATIONAL PROCEDURES ESTABLISHED**  
- **Daily Ops Checklist**: Morning 09:00 health bundle execution
- **Production Runbooks**: Complete operational procedures documented
- **Log Rotation**: Automated when logs exceed 500MB threshold
- **Emergency Procedures**: Documented runbooks for all failure scenarios

### **✅ SYSTEM TRANSPARENCY ACHIEVED**
- **Public Operations Dashboard**: https://theedges.work/project/ops/250808-post-cutover
- **Live SLO Metrics**: JSON APIs for automated monitoring integration
- **Team Notifications**: Telegram alerts for all operational events
- **Documentation Sync**: Real-time updates to operational status

## 🎯 **PRODUCTION DEPLOYMENT COMPLETE**

### **✅ PHASE P0-P1: FOUNDATION** (COMPLETE)
✅ **System Snapshot**: Full SSD backup created before changes  
✅ **Architecture Restoration**: Local Orchestrator + 3 Cores deployed  
✅ **Legacy Preservation**: Adapter/shim system maintaining compatibility  
✅ **Shadow Mode Testing**: Orchestrator validation without disruption

### **✅ PHASE P2-P3: INTEGRATION** (COMPLETE) 
✅ **Filesystem Normalization**: Agreed directory structure implemented  
✅ **Dashboard Binding**: dashboard.theedges.work live and accessible  
✅ **DNS Configuration**: Cloudflare tunnel operational  
✅ **Entry Channel Unification**: All traffic via 02luka:entry:requests

### **✅ PHASE P4-P6: PRODUCTION CUTOVER** (COMPLETE)
✅ **Shadow Mode Disabled**: Full production routing active  
✅ **SLO Monitoring**: Comprehensive health and performance tracking  
✅ **Operational Framework**: Daily ops, runbooks, and procedures  
✅ **Public Documentation**: Complete ops pack published to theedges.work

## 📊 **PRODUCTION METRICS & STATUS**

### **Operational Score: 95% - Universal Agent Architecture Ready**

**✅ Production Active (5 Core Services + Security Complete):**
- **Core Services**: Redis (✅), gc_core (✅), Prometheus (✅), Grafana (✅), Alertmanager (✅)
- **Security Status**: Credential management fixed, hardcoded secrets removed (2025-08-19) ✅
- **Monitoring**: Grafana "No data" issue resolved, MCP timeout errors fixed ✅
- **MCP Integration**: Timeout errors (-32001) & UUID validation completely fixed ✅  
- **Verification**: All systems tested and verified working before claiming completion ✅

**✅ Current Health Status (Last Check: 2025-08-19T19:34:32Z):**
- **Service Health**: 5/5 core services healthy - **EXCELLENT** 
- **Security Status**: All credentials secured, no hardcoded secrets - **EXCELLENT**
- **Monitoring Stack**: Grafana dashboards working with real data - **EXCELLENT**
- **MCP Integration**: Both timeout (-32001) & UUID validation errors resolved - **EXCELLENT**
- **Verification Protocol**: "Test and verify before claim" - **IMPLEMENTED**

### **Production Achievements:**
1. **Docker Containerization Complete**: 6/6 core agents containerized with shared-base architecture
2. **40-60% Disk Optimization**: Reduced from 5-10GB to 3.7GB via layer reuse
3. **Zero-Downtime Migration**: Dual profiles (shared + clc-legacy) for safe rollback
4. **Production Documentation**: AGENT_ROLE_MAP.md + 250814_agent_role_map.yaml aligned
5. **Monitoring Infrastructure**: All containers healthy with automated health checks

### **Operational Excellence:** **PRODUCTION READY** - Comprehensive monitoring, documentation, and operational procedures established

---

## 🎯 **DAILY OPERATIONAL PROCEDURES**

### **✅ Daily Operations (09:00):**
1. ✅ **Health Bundle Execution**: Automated SLO and smoke test verification
2. ✅ **Dashboard Review**: Check https://dashboard.theedges.work accessibility
3. ✅ **SLO Compliance Check**: Verify response times and error rates
4. ✅ **Log Review**: Monitor audit trails and system health

### **✅ Automated Monitoring (Continuous):**
1. ✅ **5-Minute Heartbeat**: Quick health probes for all components
2. ✅ **SLO Tracking**: Real-time performance and availability monitoring  
3. ✅ **Audit Trail**: Complete logging via 02luka:audit:log
4. ✅ **Telegram Notifications**: Team alerts for operational events

### **✅ Production Maintenance (As Needed):**
1. ✅ **Log Rotation**: Automated when logs exceed 500MB
2. ✅ **System Updates**: Coordinated through Local Orchestrator
3. ✅ **Performance Optimization**: Based on SLO metrics and trends
4. ✅ **Documentation Updates**: Real-time sync with operational status

---

*🚀 This dashboard reflects PRODUCTION ACTIVE STATUS - Local Orchestrator + 3 Cores operational*  
*📊 Operational Score: 95% - Full production deployment with comprehensive monitoring*  
*✅ Production Breakthrough: Complete architecture transformation with zero downtime*  
*🎯 Operational Excellence: Full SLO compliance, automated testing, and public transparency*  
*⏰ Production Cutover Complete: 2025-08-08T04:55:00*  
*📋 Complete Operations Pack: https://theedges.work/project/ops/250808-post-cutover*



---

## 🔄 **VISIBLE DELEGATION PIPELINE - STANDARD PROTOCOL** (NEW - Production Ready)
**🕐 IMPLEMENTED:** 2025-08-08T06:30:00 - Complete visible accountability system  
**🎯 STATUS:** ✅ PRODUCTION READY - Standard for all delegation activities  
**📋 AUTHORITY:** All agents and systems MUST use this delegation flow

### **🎯 DELEGATION FLOW STANDARD** (Mandatory for All Systems)
**Complete Visible Flow:** `delegate → /output → /verify → /deliver`

```
┌─────────────────────────────────────────────────────────────────┐
│                 DELEGATION INITIATION                           │
├─────────────────────────────────────────────────────────────────┤
│ ANY SYSTEM (Claude Code, Agents, WebUI, API, CLI)             │
│ ↓                                                              │
│ Creates delegation request with complete metadata              │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                    /OUTPUT TRACKING                            │
├─────────────────────────────────────────────────────────────────┤
│ /Users/icmini/02luka/output/pending/[task_id]/                │
│ ├── metadata.json          (Complete accountability)          │
│ ├── task_data.json         (Original task specification)     │
│ ├── TASK_SUMMARY.md        (Human-readable overview)          │
│ └── STATUS.txt             (Current status tracking)          │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                 WORKER PROCESSING                              │
├─────────────────────────────────────────────────────────────────┤
│ /output/in_progress/[task_id]/ → Worker executes               │
│ /output/completed/[task_id]/   → Work finished                 │
│ + completion_data.json (Results and deliverables)             │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                  /VERIFY ACCOUNTABILITY                        │
├─────────────────────────────────────────────────────────────────┤
│ /output/verify/awaiting_verification/[task_id]/               │
│ ├── VERIFICATION_REQUEST.md (Review requirements)             │
│ ├── verification_result.json (Approval/rejection)             │
│ └── Assigned verifier processes with scoring                   │
│ ↓                                                              │
│ /output/verify/verified/[task_id]/ (Approved)                 │
│ /output/verify/rejected/[task_id]/ (Failed - triggers recheck)│
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│               /DELIVER READY-TO-USE                            │
├─────────────────────────────────────────────────────────────────┤
│ /output/deliver/ready/[task_id]/                              │
│ ├── DELIVERY_GUIDE.md      (Implementation instructions)      │
│ ├── delivery_manifest.json (Complete package details)        │
│ └── All files ready for immediate deployment                   │
│ ↓                                                              │
│ /output/deliver/delivered/[task_id]/ (Active in production)   │
└─────────────────────────────────────────────────────────────────┘
```

### **📋 MANDATORY METADATA STANDARD** (All Delegations Must Include)
**✅ Sender Information:**
- `sender`: Who initiated the task (user/system/agent)
- `sender_system`: Originating system or interface
- `delegation_source`: Source context of delegation

**✅ Worker Assignment:**
- `worker`: Assigned agent/worker name
- `worker_type`: Type of worker (agent/human/system)
- `assigned_at`: Assignment timestamp with timezone

**✅ Task Definition:**
- `purpose`: Task intent and business purpose
- `goal`: Specific objective and success criteria
- `category`: Task classification for routing
- `priority`: 1-5 priority level (1=critical, 5=maintenance)
- `complexity`: low/medium/high complexity assessment

**✅ Revision Control:**
- `revision`: Current revision number
- `modification_history`: Complete change log array with:
  - `revision`: Revision number
  - `modified_at`: ISO timestamp
  - `modified_by`: Actor (person/system/agent)
  - `change_type`: Type of change (creation/update/completion/verification)
  - `description`: Human-readable change description

**✅ Verification Requirements:**
- `verify_by`: Assigned verifier name
- `verification_required`: Boolean verification flag
- `verification_criteria`: Array of validation criteria
- `verification_status`: pending/verified/rejected
- `approval_chain`: Complete approval trail with scores

**✅ Business Context:**
- `business_value`: Expected value percentage (0-100)
- `roi_estimate`: Return on investment estimate
- `strategic_importance`: high/medium/low classification
- `automation_level`: full/supervised/manual

### **⚖️ BALANCE AND RECHECK MECHANISMS** (Automatic Quality Control)
**🔍 Balance Monitoring Thresholds:**
```json
{
  "max_pending_per_worker": 10,
  "max_verification_time_hours": 24,
  "quality_score_minimum": 0.8,
  "recheck_trigger_threshold": 3
}
```

**🔄 Automatic Recheck Process:**
1. **Task Rejection** → Increment recheck counter in metadata
2. **Threshold Reached** → Automatic escalation or archival decision
3. **High Importance** → Manual escalation to system administrators
4. **Quality Alerts** → Automatic balance report generation
5. **System Optimization** → Load balancing and capacity adjustments

### **🚀 IMPLEMENTATION COMMANDS** (Standard for All Systems)
**Setup Visible Delegation (One-time):**
```bash
python3 tools/visible_pipeline_tracker.py --setup
```

**Create Visible Delegation:**
```bash
python3 tools/integrated_visible_pipeline.py --run-cycle --categories system_health optimization --limit 5
```

**Monitor Pipeline Status:**
```bash
python3 tools/visible_pipeline_tracker.py --status
python3 tools/visible_pipeline_tracker.py --balance-check
```

**Check Delegation Directory:**
```bash
ls -la /Users/icmini/02luka/output/pending/     # View pending tasks
ls -la /Users/icmini/02luka/output/verify/      # Check verification queue
ls -la /Users/icmini/02luka/output/deliver/     # See ready deliverables
```

### **🎯 DELEGATION ENGINE CENTRALIZATION** (Single Point of Control)
**✅ Central Delegation Engine:** `tools/integrated_visible_pipeline.py`  
**✅ Central Tracking System:** `tools/visible_pipeline_tracker.py`  
**✅ Central Directory Structure:** `/Users/icmini/02luka/output/`

**If delegation problems occur:**
1. **Check Central Engine:** `python3 tools/integrated_visible_pipeline.py --status`
2. **Verify Directory Structure:** `ls -la output/`
3. **Review Balance Report:** `cat output/BALANCE_REPORT.json`
4. **Check Metadata Integrity:** `python3 tools/visible_pipeline_tracker.py --balance-check`
5. **Fix at Central Level:** All fixes applied to central engine affect all delegations

### **📊 VISIBILITY BENEFITS** (Why This Standard is Mandatory)
**✅ Complete Accountability:** Every action tracked with full audit trail  
**✅ Quality Assurance:** Mandatory verification with scoring and approval chains  
**✅ Balance Monitoring:** Automatic load balancing and quality control  
**✅ Recheck Mechanisms:** Failed tasks automatically escalated or retried  
**✅ Ready-to-Use Output:** All deliverables prepared with implementation guides  
**✅ Central Management:** Single point of control for all delegation activities  
**✅ Business Intelligence:** ROI tracking and value measurement built-in

### **🔧 INTEGRATION REQUIREMENT** (Mandatory for All Agents)
**All systems that create delegations MUST:**
1. Use the visible pipeline tracker for task creation
2. Include complete metadata as specified above
3. Follow the /output → /verify → /deliver flow
4. Implement balance checking and recheck mechanisms
5. Generate ready-to-use deliverables with implementation guides

**Non-compliance results in:**
- Tasks without proper tracking are automatically rejected
- Missing metadata triggers system alerts and escalation
- Balance violations cause automatic load rebalancing
- Quality failures trigger recheck processes

**This delegation standard ensures complete system accountability and operational excellence.**

---

## 💾 **STORAGE ARCHITECTURE** (UPDATED - 2025-10-31)
```
Mac Mini (192.168.1.43) - PRIMARY HUB 24/7
├── Internal SSD: 43GB available / 460GB total (11GB used, 21%) ✅ STABLE
├── /Users/icmini/02luka/ (4.0GB system files)
└── External SSD (/Volumes/lukadata) - 481GB available / 931GB total (450GB used, 48%) ✅ HEALTHY
    ├── Steam/ (60 GB - gaming)
    ├── ollama_fixed/ (56 GB - 10 LLM models, ACTIVE) ✅ PROTECTED
    ├── ollama_system/ (50 GB - failed downloads, ABANDONED, safe to delete)
    ├── Photo Libraries/ (20 GB)
    ├── ML_Archive/ (18 GB)
    ├── _gd_union_stage/ (11 GB - recent transfer from Desktop)
    ├── Legacy systems/ (11 GB)
    ├── 02luka_archives/, 02luka_data/, 02luka_git_*/ (backups, snapshots)
    ├── llm_repos/ (10 GB)
    └── .Spotlight-V100/ (2.1 GB - old index, disabled)

Ollama Defense-in-Depth Configuration (2025-10-31):
├── Layer 1: ~/.ollama → /Volumes/lukadata/ollama_fixed (symlink)
├── Layer 2: OLLAMA_MODELS=/Volumes/lukadata/ollama_fixed (env var)
├── Layer 3: LaunchAgent OLLAMA_MODELS configured
├── Verification: ~/tools/verify_ollama_path.zsh (6-point health check)
└── Documentation: ~/Library/Logs/02luka/OLLAMA_CONFIGURATION.md

System Guard Combo (2025-10-31):
├── Script: ~/tools/system_guard_combo.zsh (360 lines, 7 modules)
├── LaunchAgent: com.02luka.system-guard (every 30 min, priority +10)
├── Modules:
│   1. Spotlight Guard (lukadata protected - indexing disabled)
│   2. Smart Rsync (excludes node_modules, .next, dist, build)
│   3. Disk Swing Monitor (alerts ±5 GB swings in 10 min)
│   4. Snapshot Cleanup (every 48h, automatic)
│   5. Memory Check (alerts <100 MB, auto-collects samples)
│   6. Health Report (load, disk, spotlight, processes)
│   7. Adaptive Anomaly Detection (z-score 2.5σ, 21 samples)
├── Adaptive Learning: ~/tools/system_guard_adaptive.zsh (400+ lines)
├── Learned Thresholds: RAM<34MB (vs 100MB), Load>17.3 (vs 5.0)
└── Logs: ~/Library/Logs/02luka/system_guard_combo.log

Symlink Configuration:
├── /Users/icmini/02luka/lukadata_link → /Volumes/lukadata
├── /Users/icmini/02luka/logs → /Volumes/lukadata/02luka_data/logs
├── /Users/icmini/02luka/venv* → /Volumes/lukadata/02luka_data/venv*
├── ~/.ollama → /Volumes/lukadata/ollama_fixed (Ollama models)
└── LUKADATA_PATH=/Users/icmini/02luka/lukadata_link (configured)

MacBook Pro (192.168.1.41) - SECONDARY
├── Development environment with intelligent sync
└── Auto-sync protocols active
```

### 🛡️ **System Guard + Adaptive Learning (2025-10-31)** ✅ OPERATIONAL
- **System Guard Combo**: 7-module resource protection, auto-run every 30 minutes
- **Adaptive Learning**: Statistical anomaly detection with personalized thresholds
- **Spotlight Protection**: lukadata indexing disabled (prevents 650 MB mds_stores RAM usage)
- **Disk Swing Prevention**: Real-time monitoring, 0 GB swing (previously ±10 GB issue)
- **Memory Optimization**: Free RAM 43-185 MB (adaptive threshold 34 MB learned)
- **Smart Rsync**: Auto-excludes node_modules (93% size reduction)
- **Verification**: 6-point health check script operational
- **Documentation**: Complete manuals with troubleshooting guides

### 🧙 **Ollama Defense-in-Depth (2025-10-31)** ✅ CONFIGURED
- **Triple Protection**: Symlink + Env var + LaunchAgent config
- **Active Models**: 10 models (qwen3:30b 18GB, gpt-oss:20b 13GB, llama3.1:8b 4.9GB, etc.)
- **Storage**: ollama_fixed 56 GB (ACTIVE), ollama_system 50 GB (ABANDONED)
- **Verification**: ~/tools/verify_ollama_path.zsh (all checks passing)
- **API Status**: Port 11434 responding, 10 models available
- **Recovery**: Complete emergency procedures documented
- **Cleanup Opportunity**: 50 GB recoverable from ollama_system (safe to delete)

### 📊 **Large Files Index** (Updated 2025-10-31)
- **Ollama Models**: 10 active models (2.0GB to 18GB each) in ollama_fixed
- **Steam**: 60 GB (games)
- **Photo Libraries**: 20 GB
- **ML Archive**: 18 GB
- **Primary Storage**: `/Volumes/lukadata/ollama_fixed/models/blobs` (46 blobs, active)
- **Abandoned Storage**: `/Volumes/lukadata/ollama_system/models/blobs` (11 partial files, safe to delete)

## 🔒 **PROTECTION ZONES - NEVER MODIFY**
- `/CLC/` - Documentation & protocols
- `/agents/` - Agent ecosystem  
- `/core/` - System framework
- `/memory/` - AI memory systems
- `/system/` - Protected backend
- `/Volumes/lukadata/` - External SSD storage

## 💾 **MEMORY SAVE PROTOCOL**
- **Command:** `/save` - Updates all system files + session memory
- **Frequency:** Required at session end
- **Auto-sync:** Mac mini ↔ MacBook Pro

## 🚨 **EMERGENCY PROCEDURES**
1. **System Down:** Check this dashboard → Restart failed services
2. **Agent Issues:** Check Process Status table → Restart specific agent
3. **Redis Problems:** Verify password `changeme-02luka` → Restart Redis
4. **Budget Alert:** Monitor cost section → Activate limits

---

## 🎯 **QUICK ACTIONS** (GC-First Toolkit + MCP Enhanced)

### 🤖 **AI AGENT COMMANDS** (For Autonomous Operations)
```bash
# GC Toolkit Operations (Primary)
gc ops.rollup                                              # Master health check 
gc fastvlm.health                                          # FastVLM service ping
gc tunnel.status                                           # Cloudflare tunnel status
gc tunnel.restart                                          # Emergency tunnel restart

# AI System Status & Verification
python3 tools/auto_verify_template.sh system_health        # Auto-verify system
python3 tools/comprehensive_system_verification.py         # Full AI verification
curl -s http://localhost:8080/api/status                   # Machine-readable status

# MCP Protocol Communication  
/Users/icmini/Shared/02luka/bin/gg-mcp gg-coordinator --test    # Test MCP server
/Users/icmini/Shared/02luka/bin/gg-mcp gg-direct --check        # Direct MCP check
~/02luka/scripts/start_mcp_gg_direct_fixed.sh                  # ✅ MCP timeout fix VERIFIED (2025-08-20)

# AI Task Delegation (Structured/Automated)
python3 tools/integrated_visible_pipeline.py --run-cycle        # Execute AI delegation
python3 tools/visible_pipeline_tracker.py --status             # AI pipeline status
redis-cli -a changeme-02luka xlen 02luka:entry:requests             # AI entry queue

# AI Verification & Validation
python3 tools/debug_verification_system.py enhanced            # AI verification tests
python3 tools/task_validate.sh                                 # Task validation
python3 tools/tasks_reconciler.sh                              # Task reconciliation
```

### 👤 **HUMAN OPERATOR COMMANDS** (For Manual Operations)
```bash
# Human-Readable Status & Dashboards
curl -s https://dashboard.theedges.work/health                 # Web dashboard
open http://localhost:5601                                     # Kibana logs UI
/Users/icmini/02luka/monitoring/check_elk_status.sh           # ELK status checker

# Manual Monitoring & Operations
python3 ops/probes/slo_probe.py                               # SLO compliance
python3 tools/smoke_tests.py                                  # Manual smoke tests
./ops/daily/250808_ops_checklist.sh                          # Daily operations

# Log Analysis (Human-Readable)
tail -f logs/local_orchestrator.log                          # Real-time orchestrator
tail -f logs/02luka_audit.log                                # Human audit trail
tail -f ops/reports/250808_slo_report.json                   # SLO metrics

# Service Management (Manual Control)
python3 agents/mary/mary.py &                                # Start Mary manually
python3 core/local_orchestrator.py &                         # Start orchestrator
docker-compose -f monitoring/docker-elk/docker-compose.yml up -d  # Start ELK stack
```

### ⚡ **SHARED SYSTEM COMMANDS** (Both AI and Human)
```bash
# Core Infrastructure
redis-cli -a changeme-02luka ping                                 # Redis connectivity
ollama list                                                  # Local AI models
docker ps                                                    # Container status
ps aux | grep "python3.*02luka" | grep -v grep             # Active processes
```

---

## 📋 **MANDATORY READING PROTOCOL FOR ALL AGENTS**
1. **READ FIRST:** This file (02luka.md) - Current system status  
2. **CHECK:** system_status.json - Machine-readable data  
3. **REVIEW:** agent_registry.md - Role assignments  
4. **CONSULT:** CLC/INDEX.md - Documentation center

---

## 🔄 **Phase 5.3 - Auto-Verify Protocol & MCP System Integration**

### Status: ✅ COMPLETED (2025-08-09T02:05:00)
**Goal:** Implement mandatory auto-verification protocol and universal MCP system for comprehensive verification.

### ✅ Implemented Components:
- **Auto-Verify Protocol**: Mandatory verification before all completion claims (`250809_AUTO_VERIFY_BEFORE_CLAIM_PROTOCOL.md`)
- **Universal MCP Wrapper**: Multi-device MCP server system with JSON-RPC 2.0 compliance
- **Bridge Hardening**: SHA256 deduplication, state persistence, monitoring API
- **UDS Ingress System**: Local-only task submission via Unix Domain Socket
- **Verification Template**: Auto-verification tool for all system types
- **Claude Desktop Integration**: MCP server configuration ready

### 🔧 Technical Details:
- **Auto-Verify Tool**: `/tools/auto_verify_template.sh` (6 verification types)
- **MCP Wrapper**: `/Users/icmini/Shared/02luka/bin/gg-mcp` (universal)
- **Bridge Monitoring**: `http://127.0.0.1:8765/bridge/health` (operational)
- **UDS Socket**: `/Users/icmini/02luka/run/sockets/gg_ingest.sock` (healthy)
- **System Status**: 🟢 FULLY OPERATIONAL (12 published, 13 pending, 1 in progress, 1 completed)
- **Verification Status**: ✅ ALL SYSTEMS VERIFIED using native MCP protocol capabilities

### 🎯 **Auto-Verify Mandate**:
**"verify before claim > is a must"** - **EVERY COMPLETION CLAIM REQUIRES VERIFICATION**

## 📊 **Phase 5.4 - ELK Stack Monitoring Integration**

### Status: ✅ COMPLETED (2025-08-09T05:42:00)
**Goal:** Deploy comprehensive log monitoring and analysis with ELK stack for centralized system observability.

### ✅ Deployed Components:
- **Elasticsearch 8.15.0**: Data storage and indexing engine (Port 9200)
- **Kibana 8.15.0**: Web dashboard for log visualization and analysis (Port 5601)
- **Logstash 8.15.0**: Log processing pipeline with custom 02luka configuration (Port 5044)
- **Status Monitoring**: `/Users/icmini/02luka/monitoring/check_elk_status.sh`

### 🔧 Technical Implementation:
**📁 ELK Stack Location**: `/Users/icmini/02luka/monitoring/docker-elk/`

**📊 Log Sources Configured:**
- System logs: `/Users/icmini/02luka/logs/**/*.log`
- Entry router logs: `/tmp/entry_router.out`
- Tasks reconciler: `/tmp/tasks_reconciler.out`
- GG coordinator: `/tmp/gg_coordinator.out`
- Error streams: `*.err` files from `/tmp/`

**🎯 Processing Pipeline:**
- Automatic timestamp extraction (ISO8601 format)
- Message parsing with grok patterns
- Daily indices: `02luka-logs-YYYY.MM.dd`
- Structured field mapping for searchability

### 🌐 Access Information:
- **Kibana Dashboard**: http://localhost:5601
- **Elasticsearch API**: http://localhost:9200
- **Credentials**: elastic / ChangeMePlease_02luka
- **Index Pattern**: `02luka-logs-*`

### 🚀 Next Steps:
```bash
# Check ELK status
/Users/icmini/02luka/monitoring/check_elk_status.sh

# Create Kibana index pattern for 02luka-logs-*
# Access Kibana → Discover → Create data view
```

### 📈 Benefits:
- **Centralized Logging**: All system logs in one searchable interface
- **Real-time Monitoring**: Live log ingestion and analysis
- **Historical Analysis**: Full log retention with time-series visualization
- **Advanced Search**: Regex and field-based query capabilities
- **Alert Integration**: Ready for alert rules and notification setup

---

## 📊 **Phase 5.5 - Local Agent System Deployment Complete**

### Status: ✅ COMPLETED (2025-11-01T04:01:20)
**Goal:** Fix macOS compatibility issues and complete local agent system deployment with full operational verification.

### ✅ Fixes Applied:
- **run_shell.zsh**: Replaced `date +%s%3N` with Python millisecond timestamps for macOS compatibility
- **LaunchAgent PATH**: Added /opt/homebrew/bin to PATH environment for redis-cli accessibility
- **Backup Created**: `run_shell.zsh.bak.251101_035707`

### 🔧 Technical Implementation:

**📁 Modified Files:**
```bash
# Core skill patched for macOS compatibility
/Users/icmini/LocalProjects/02luka_local_g/g/skills/run_shell.zsh
  - Line 12: START timestamp (Python-based)
  - Line 46: END timestamp (Python-based)

# LaunchAgent environment configuration
~/Library/LaunchAgents/com.02luka.agent_listener.plist
  - Added PATH: /opt/homebrew/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
```

**✅ Verification Results:**
```
LaunchAgent:      Running (PID 6772, exit code 0)
LightRAG Agents:  8/8 healthy (ports 7210-7217)
Redis:            Connected (PONG)
End-to-End Flow:  ok=True (check_health passed, 270ms)
Skills Tested:    http_fetch.py ✅, run_shell.zsh ✅
```

### 🌐 Architecture:
```
Redis Pub/Sub → agent_listener.py → agent_router.py → 8 skills → results
                  (daemon)           (stateless)      (whitelisted)
```

**Channels Monitored (7):**
- gg:agent_router (main dispatch)
- gg:nlp_router (NLP processing)
- gg:direct_router (direct commands)
- kim:agent, telegram:agent, clc:agent, cls:agent

**Core Skills (8):**
- http_fetch.py, run_shell.zsh, launchctl_ctl.zsh, file_ops.zsh
- redis_ops.zsh, log_tail.zsh, process_info.zsh, system_health.zsh

### 📚 Documentation Created:
- `phase_5_5_deployment_report.md` (213 lines) - Complete deployment history
- `local_agent_system_manual.md` (385+ lines) - Operations & troubleshooting guide
- `verify_deployment.sh` - Automated verification script

### 🚀 System Commands:
```bash
# Quick health check
bash /tmp/verify_deployment.sh

# Check LaunchAgent status
launchctl list | grep com.02luka.agent_listener

# Test end-to-end flow
redis-cli PUBLISH gg:agent_router '{"intent":"check_health"}'

# View logs
tail -f ~/02luka/logs/agent/listener.log
```

### 📈 Benefits:
- **Cross-Platform Compatibility**: Works on macOS and Linux without modification
- **Full Audit Trail**: All tasks tracked via receipts + results (JSON format)
- **Persistent Daemon**: Auto-restart on failure (KeepAlive + RunAtLoad)
- **Security Hardening**: Whitelisted commands only + CloudStorage path blocking
- **Performance**: 270ms skill chain execution, <1% CPU idle, ~25MB memory

### 🎯 System Status:
**Local Agent Stack: ✅ OPERATIONAL**
- Mode: redispy (redis-py library)
- Timeout Protection: 180s per task
- Zero Downtime Deployment: Yes

---

**🤖 Enhanced Dashboard Authority:**

### 📋 **TIMESTAMP VERIFICATION** (Critical for Accuracy)
- **Part 1 (Architecture):** 🕐 **UPDATED: 2025-08-14T18:45:00Z** (GC Orchestrator MCP Operations)
- **Part 2 (Operations):** 🕐 **UPDATED: 2025-09-08T10:50:34Z** (Docker Build + N8N Collision Resolution Complete)
- **Current Status:** 🚀 PRODUCTION ACTIVE - MCP tools operational + Ollama cleanup completed
- **System Health:** ✅ **EXCELLENT** - All components + Ollama (10 models) + Storage (35% healthy)
- **Architecture Status:** 🎯 **ENHANCED PRODUCTION** - MCP protocol proven + system optimization active
- **Recent Operation:** ✅ **OLLAMA CLEANUP SUCCESS** - 607GB available, quarantine protocol deployed

### 🔍 **RELIABILITY STATUS**
- **Claude Code Updates:** ✅ Real-time verification every session with ELK monitoring
- **Operational Monitoring:** ✅ **FULLY ENHANCED** - ELK stack + MCP system + bridge hardening
- **Production Verification:** ✅ **COMPREHENSIVE** - ELK-powered observability + MCP protocol validation
- **Trust Level:** Both Parts = 100% current | ELK monitoring enforced system-wide

*🚀 Remember: This system now includes comprehensive ELK stack monitoring for complete observability alongside "verify before claim > is a must" protocol. Full operational transparency with ELK-powered log analysis active.*

## Interfaces: AI vs HUMAN (Canonical)

### 🤖 For AI Agents
- **PRIMARY ENTRY:** `/Users/icmini/02luka/ai_context_entry.md` ← **START HERE ALWAYS**
- **Unified reading order:** Current work → System context → Historical (no conflicts)
- **Quick access:** `ai_context/01_current_work.json`, `02_task_details.md` for active tasks
- **Machine-readable status**: `/Users/icmini/02luka/run/system_status.v2.json`
- **GC Toolkit**: `gc ops.rollup`, `gc fastvlm.health`, `gc tunnel.status`, `gc tunnel.restart`
- **Protocols**: JSON-RPC MCP (stdio), Redis streams, FastVLM health monitoring
- **MCP Fix & Verify**: All system fixes via MCP protocol tools
- **Auto-Verification**: mandatory for all agent actions
- **Standards**: YYMMDD_**name**.md files, use system catalog, CLC+GC complementary

### 👤 For Human Operators
- **Web Dashboard**: https://dashboard.theedges.work
- **Kibana (Local Logs)**: http://localhost:5601
- **Local HTML Dashboard**: `/Users/icmini/02luka/run/reports/local_dashboard.html`
- **Runbooks & CLI tools**: under `/Users/icmini/02luka/tools`
- **Manual verification**: overrides per SOP

### ⚡ Shared
- **Root**: `/Users/icmini/02luka`
- **Health artifacts**: `/tmp/*.out|*.err`
- **Audit logs**: `/Users/icmini/02luka/logs`

---

<!-- AUTO-UPDATED: DASHBOARD START -->
**FastVLM Status** ![FastVLM](https://img.shields.io/badge/FastVLM-HEALTHY-success)
- Local: http://127.0.0.1:8765/health
- Public: https://vlm2.theedges.work/health
- Last Update: 2025-08-12T10:52:00Z
- GC Toolkit: ✅ All 4 commands operational
- Tunnel: ✅ 4 connections (bkk04,bkk08,sin02,sin12)
- Redis: ✅ v8.2.0 running, PATH fixed
- Success Rate: 100.0%
<!-- AUTO-UPDATED: DASHBOARD END -->


## 🔧 System Stabilization Report - 2025-08-14 04:32

### ✅ Fixes Applied (9):
- Fixed LaunchAgent: com.02luka.healthprobe
- Fixed LaunchAgent: com.02luka.system_runner
- Fixed LaunchAgent: com.02luka.clc.dispatcher
- Fixed LaunchAgent: com.02luka.mary
- Fixed LaunchAgent: com.02luka.fastvlm
- Fixed LaunchAgent: com.02luka.paula
- Created consolidated heartbeat service
- Trimmed 02luka:heartbeats: 20 messages
- Created system health monitor

### ⚠️ Issues Found (0):


### 🚀 New Stability Features:
- **Consolidated Heartbeat Service**: Single source for all heartbeats
- **System Health Monitor**: Auto-healing and resource monitoring  
- **Optimized Redis Streams**: Trimmed and reset for performance
- **Fixed LaunchAgent Configurations**: Proper paths and environments

### 📊 System Status:
- **Core Services**: Running with auto-healing
- **Heartbeat System**: Consolidated and stable
- **Redis Streams**: Optimized and monitored
- **LaunchAgents**: Fixed configurations

**Last Updated**: 2025-08-14T04:32:18.306931

## 🎉 COMPLETE SYSTEM VERIFICATION - 2025-08-14 13:30

### ✅ COMPREHENSIVE END-TO-END VERIFICATION COMPLETED:
**ALL SYSTEMS VERIFIED AND OPERATIONAL:**
- 🤖 **All 6 Agents**: Mary, Paula, Keane, QS, Sumo, Rooney - 100% OPERATIONAL
- 🔄 **Redis Infrastructure**: All consumer groups healthy, 0 pending messages  
- 💬 **Conversation History**: Complete Redis Streams implementation with Thai/English
- 🛠️ **Tool Ecosystem**: All 5 tools executable and production-ready
- 🔧 **Response Format**: Dual-stream compatibility achieved across all agents

### 📊 VERIFIED SYSTEM STATUS:
**Overall Health Score: 100% - ALL SYSTEMS OPERATIONAL**
- ✅ **Agent Processes**: 6/6 running with healthy runtimes (12min-29hrs)
- ✅ **Consumer Groups**: 6/6 active with 0 pending messages (CRITICAL FIX)
- ✅ **Response Routing**: All agents sending to both individual + main streams
- ✅ **Conversation System**: 7 active sessions tracked, JSONL export working
- ✅ **Redis Health**: PONG response, 37+ messages processed in main stream
- ✅ **Tools Functional**: CLI, export, monitoring, cleanup all verified

### 🔧 CRITICAL ISSUES RESOLVED:
- **Consumer Group Blocking**: All pending messages cleared from Sumo/Rooney
- **Response Format Standardization**: Added dual-stream to Keane, QS, Sumo, Rooney
- **Conversation History Implementation**: Complete Redis Streams system deployed
- **JSON Data Errors**: All Redis DataError issues resolved with proper encoding
- **Tool Ecosystem**: All conversation history tools verified and production-ready

### 💬 CONVERSATION HISTORY SYSTEM DEPLOYED:
- **Architecture**: 3-layer Redis Streams → JSONL → /output tracking
- **CLI Interface**: `tools/conv` with stats, list, export, cleanup commands
- **Agent Integration**: Non-invasive monitoring via `agent_conversation_wrapper.py`
- **Multi-language**: Thai/English Unicode content fully supported
- **Export Format**: JSONL files (1.6KB avg) for long-term analysis
- **Retention**: Automated cleanup with 30-day retention policies

### 🎯 PRODUCTION DEPLOYMENT STATUS:
**🚀 READY FOR IMMEDIATE PRODUCTION USE**
- **Task Processing**: All 6 agents responding within 2-3 seconds
- **Conversation Tracking**: Real-time logging with export capabilities  
- **Response Consistency**: Dual-stream format across all agents
- **Tool Integration**: Complete CLI management suite operational
- **Documentation**: Comprehensive system guides and procedures complete
- **Maintenance**: Automated cleanup and monitoring procedures implemented

### 📈 PERFORMANCE METRICS:
- **Response Times**: 0.1-3 seconds across all agents
- **Throughput**: 37+ messages processed in main stream today
- **Conversation Events**: 33+ events across 7 active sessions
- **Storage Efficiency**: 1.6KB average per exported conversation
- **Reliability**: 100% dual-stream compliance, zero Redis errors

### 🏆 VERIFICATION ACHIEVEMENTS:
**ORIGINAL ISSUES COMPLETELY RESOLVED:**
- ✅ Consumer group issues preventing task processing → FIXED
- ✅ Response format inconsistencies → STANDARDIZED  
- ✅ Agent communication problems → ALL WORKING
- ✅ Missing conversation tracking → FULLY IMPLEMENTED

**ADDITIONAL VALUE DELIVERED:**
- ✅ Production-ready conversation history system with Thai/English support
- ✅ Complete tool ecosystem with CLI management interface
- ✅ Comprehensive documentation and maintenance procedures
- ✅ Non-invasive monitoring without agent performance impact
- ✅ Automated retention policies and export capabilities

**System Status**: 🎯 **ALL SYSTEMS GO - PRODUCTION READY**

**Last Updated**: 2025-08-14T13:30:00Z

## 🔐 **CENTRALIZED SECRETS MANAGEMENT**
**🕐 LAST VERIFIED:** 2025-08-21T08:30:00Z by GC Orchestrator MCP Operations  
**🔒 SECURITY STATUS:** Production-grade secrets architecture implemented  
**📋 VERIFICATION:** All services using centralized credentials successfully  

### 🎯 **Secrets Architecture Layout**
**Centralized credential management with layered security:**

```
/Users/icmini/02luka/
├── .env                    # Main environment variables (non-sensitive + service configs)
├── .env.secrets           # Secure credentials (Grafana API, primary Redis auth)
├── .env.telegram          # Telegram bot tokens (legacy compatibility)
├── .env.discord           # Discord bot tokens (legacy compatibility)
└── config/secrets/        # Service-specific credential files
    ├── telegram.env       # Updated Telegram bot tokens (all working)
    ├── discord.env        # Discord webhook + bot configurations  
    └── alerting.env       # Alert system credentials (references)
```

### 🔑 **Current Services Integration**
**All services verified using centralized secrets:**

| Service | Primary Credentials | Backup Location | Status |
|---------|-------------------|-----------------|--------|
| **Redis** | `.env` → `REDIS_PASSWORD` | `.env.secrets` | ✅ Working |
| **Telegram Bots** | `config/secrets/telegram.env` | `.env.telegram` | ✅ 5 Active Tokens |
| **Discord** | `config/secrets/discord.env` | `.env.discord` | ✅ Webhook + Bot |
| **Grafana API** | `.env.secrets` → `GRAFANA_API_TOKEN` | - | ✅ 24h Expiry |
| **MCP Services** | `.env` → `MCP_API_KEY` | `config/secrets/discord.env` | ✅ Operational |

### 🛡️ **Security Implementation**
**Production-grade credential protection:**

- **No Hardcoded Secrets**: All credentials removed from source code ✅
- **Environment Isolation**: Separate `.env.secrets` for sensitive data ✅  
- **Service Segmentation**: Individual credential files per service ✅
- **Legacy Compatibility**: Dual-location support during migration ✅
- **Token Rotation Ready**: Quarterly rotation policy framework ✅

### 📊 **Evidence Collected (2025-08-21T08:30:00Z)**
**GC Orchestrator verification results:**

```bash
# Environment Variables Status
REDIS_PASSWORD: ✅ Set (24-char secure password)
TELEGRAM_BOT_TOKEN: ✅ Set (5 active bot tokens)
DISCORD_BOT_TOKEN: ✅ Set (webhook + bot integration)
GRAFANA_API_TOKEN: ✅ Set (24h expiry token)
MCP_API_KEY: ✅ Set (32-char hex key)

# Service Health Status  
GG-Coordinator: ✅ OPERATIONAL (pong response)
Redis Connectivity: ✅ AUTH WORKING (password accepted)
MCP Protocol: ✅ ACTIVE (JSON-RPC 2.0 compliant)
Telegram Bots: ✅ 5 TOKENS ACTIVE (verified 2025-08-21)
Discord Integration: ✅ WEBHOOK + BOT READY
```

### ⚡ **Rotation Policy Framework**
**Quarterly security maintenance schedule:**

- **Q1 (Jan-Mar)**: Telegram bot token rotation
- **Q2 (Apr-Jun)**: Discord credentials refresh  
- **Q3 (Jul-Sep)**: Grafana API token renewal
- **Q4 (Oct-Dec)**: Redis password + MCP key rotation

### 🔧 **Validation Tools**
**Automated verification capabilities:**

```bash
# Redis Authentication Test
python3 /Users/icmini/02luka/test_redis_auth.py

# GC Coordinator Health Check
gg-coordinator:ping                    # MCP protocol verification
gg-coordinator:status                  # System status check

# Environment Validation
python3 tools/validate_secrets.sh     # Preflight security gate
```

---

## Storage Architecture (update 2025-08-19T17:04:29Z)

### .git Migration to External SSD
- **Action:** Moved repository Git history off internal SSD to external volume.
- **New location:** `/Volumes/lukadata/02luka_git_1755622041/`
- **Symlink:** `/Users/icmini/02luka/.git` → `/Volumes/lukadata/02luka_git_1755622041/`
- **Size moved:** ~2.6 GB
- **Benefit:** Frees ~2.6 GB on internal disk; reduces risk at ~96% usage.
- **Ops Note:** All Git/CLC operations continue transparently via the symlink.
- **Audit Artifacts:** see `docs/ops/migrations/git_migration_1755622681.md` and `CLC/memory/autosave/dotgit_migration_1755622041.log`.


## 🔧 System Stabilization Report - 2025-08-20 05:01

### ✅ Fixes Applied (17):
- Fixed LaunchAgent: com.02luka.healthprobe
- Fixed LaunchAgent: com.02luka.tasks_reconciler
- Fixed LaunchAgent: com.02luka.backup.daily
- Fixed LaunchAgent: com.02luka.eda.alert
- Fixed LaunchAgent: com.02luka.eda.sweeper
- Fixed LaunchAgent: com.02luka.catalog.health
- Fixed LaunchAgent: com.02luka.clc.dispatcher
- Fixed LaunchAgent: com.02luka.reboot_guard
- Fixed LaunchAgent: com.02luka.entry_router
- Fixed LaunchAgent: com.02luka.status.snapshot
- Fixed LaunchAgent: com.02luka.status.bridge
- Fixed LaunchAgent: com.02luka.security.scan
- Fixed LaunchAgent: com.02luka.boot_alert
- Fixed LaunchAgent: com.02luka.queue.cleanup
- Fixed LaunchAgent: com.02luka.alerts.lag
- Created consolidated heartbeat service
- Created system health monitor

### ⚠️ Issues Found (0):


### 🚀 New Stability Features:
- **Consolidated Heartbeat Service**: Single source for all heartbeats
- **System Health Monitor**: Auto-healing and resource monitoring  
- **Optimized Redis Streams**: Trimmed and reset for performance
- **Fixed LaunchAgent Configurations**: Proper paths and environments

### 📊 System Status:
- **Core Services**: Running with auto-healing
- **Heartbeat System**: Consolidated and stable
- **Redis Streams**: Optimized and monitored
- **LaunchAgents**: Fixed configurations

**Last Updated**: 2025-08-20T05:01:52.211270

## 📅 **CALENDAR INTEGRATION SYSTEM** (Production Ready)
**🕐 DEPLOYED:** 2025-09-27T02:00:00Z - Complete iCalendar + Google Calendar API integration
**🎯 STATUS:** ✅ OPERATIONAL - Following Context API production patterns
**📋 ARCHITECTURE:** Atomic writes + LKG fallback + token security + LaunchAgent automation

### 🏗️ **Calendar System Architecture**
```
┌─────────────────────────────────────────────────────────────────┐
│                    CALENDAR DATA FLOW                           │
├─────────────────────────────────────────────────────────────────┤
│ Events Source (JSON) → Build ICS (Atomic) → LKG Fallback       │
│       ↓                    ↓                      ↓             │
│ Google Calendar API ← Secure Sync (.env) ← Health Monitoring   │
└─────────────────────────────────────────────────────────────────┘
```

### 📁 **Calendar File Layout**
```
g/tools/
├── calendar_build_ics.sh          # ICS builder with atomic writes
├── calendar_sync_gcal.sh          # Google Calendar sync (token security)
└── calendar_health_endpoint.sh    # Health check endpoint

g/fixed_launchagents/
├── com.02luka.calendar.build.plist   # ICS build every 10 min
└── com.02luka.calendar.sync.plist    # GCal sync every 30 min

run/calendar/
├── events_YYYYMMDD.json           # Daily event source
├── events_current.json            # Fallback event source
├── calendar_YYYYMMDD.ics          # Generated ICS files
├── last_known_good.ics            # LKG fallback
└── gcal_state.json                # Sync status tracking

gateway/
└── health_proxy.js                # Calendar API endpoints (3 endpoints)
```

### 🌐 **Calendar API Endpoints** (Port 3002)
| Endpoint | Method | Auth | Purpose |
|----------|--------|------|---------|
| `/calendar/ics` | GET | None | Serve ICS file (LKG fallback) |
| `/calendar/health` | GET | None | Calendar health check |
| `/calendar/gcal/sync` | POST | Token | Trigger Google Calendar sync |

### 🔐 **Security & Compliance**
**Token Security (.env only, mode 0600):**
```bash
# Required in .env (never in plists or logs)
GCAL_CREDENTIALS_JSON="..."  # Service account JSON
GCAL_CALENDAR_ID="..."       # Target calendar ID
```

**Invariants & Guardrails:**
- ✅ Atomic File Operations: temp → validate → atomic move
- ✅ LKG Fallback: Always maintain last_known_good.ics
- ✅ No Symlinks: Copy-based deployment (Mirror Mode compliant)
- ✅ Timezone Handling: UTC in ICS, Asia/Bangkok for UI
- ✅ Validation Gates: Structure checks before publish
- ✅ 7-Day Retention: Auto-cleanup old files

### 📊 **Calendar Health Monitoring**
```bash
# Check calendar health
curl http://localhost:3002/calendar/health

# Get ICS feed
curl http://localhost:3002/calendar/ics > calendar.ics

# Trigger sync (requires HEALTH_TOKEN)
curl -X POST http://localhost:3002/calendar/gcal/sync \
  -H "Authorization: Bearer $HEALTH_TOKEN"
```

### 🚀 **LaunchAgent Automation**
**Build Schedule (Every 10 minutes):**
- Label: `com.02luka.calendar.build`
- Script: `g/tools/calendar_build_ics.sh`
- Logs: `~/Library/Logs/02luka/calendar_build.*.log`

**Sync Schedule (Every 30 minutes):**
- Label: `com.02luka.calendar.sync`
- Script: `g/tools/calendar_sync_gcal.sh run`
- Logs: `~/Library/Logs/02luka/calendar_sync.*.log`

### 📋 **Operational Commands**
```bash
# Manual ICS build
/Users/icmini/My\ Drive\ (ittipong.c@gmail.com)\ (1)/02luka/g/tools/calendar_build_ics.sh

# Manual Google Calendar sync
/Users/icmini/My\ Drive\ (ittipong.c@gmail.com)\ (1)/02luka/g/tools/calendar_sync_gcal.sh run

# Check sync status
cat /Users/icmini/My\ Drive\ (ittipong.c@gmail.com)\ (1)/02luka/run/calendar/gcal_state.json

# Security check
/Users/icmini/My\ Drive\ (ittipong.c@gmail.com)\ (1)/02luka/g/tools/calendar_sync_gcal.sh check
```

### 🎯 **Production Status**
- ✅ Core Scripts: 3/3 deployed with atomic write pattern
- ✅ API Endpoints: 3/3 integrated into health_proxy.js (port 3002)
- ✅ LaunchAgent Plists: 2/2 created (manual execution verified)
- ✅ Security: Token-based auth with .env (0600)
- ✅ Fallback: LKG system operational
- ✅ WAN Control: calendar_control.sh for remote operations
- ✅ Documentation: Complete (02luka.md, CLAUDE.md, production manual)
- ✅ Tested: All endpoints verified, ICS generation working

### 🌐 **WAN Access Pattern**
Calendar operations can be triggered remotely via N8N bridge:
```bash
# From mobile/web → Local system
POST https://dashboard.theedges.work/n8n/webhook/gm-post
{
  "sender": "Boss",
  "target_core": "mary",
  "action": "execute_script",
  "payload": {
    "script": "/Users/icmini/My Drive (ittipong.c@gmail.com) (1)/02luka/g/tools/calendar_control.sh",
    "args": ["build"]  // or "sync", "health"
  }
}
```

**Local Control:**
```bash
# Direct script execution
/path/to/calendar_control.sh {build|sync|health|api-health|api-ics}
```

---

## 🚀 **GC/GG Remote Operations**

### GG→Mary→CLC Task Routing (3 Paths)

```bash
# Health check all paths:
./tools/gg_send.sh health

# Send task (auto-fallback A→B→C):
./tools/gg_send.sh CLC write_file "/path/to/output.json" '{"data":"value"}'
```

- **Path A (Redis)**: Direct to Redis gg:requests stream → Mary → CLC
- **Path B (Mobile API)**: https://mobile.theedges.work/task → Redis → Mary → CLC
- **Path C (File Drop)**: /CLC/inbox/*.json → File Watcher → CLC

## AI_OP (Authoritative)
### AI_OP (Authoritative)
- Canonical folder: `/Users/icmini/02luka/docs/ai_ops`
- Index: `/Users/icmini/02luka/docs/ai_ops/aiop_index.yaml`
- Master specs: `/Users/icmini/02luka/docs/ai_ops/master/`
- Note: `/CLC` is excluded from consolidation by policy.



---
_Normalized by normalize_and_report.py_
- **Generated (UTC):** 2025-09-05T15:09:40Z
- **Path:** `/Users/icmini/02luka/02luka.md`


### 🔌 drive_bridge (R1) - IMPLEMENTED
- Direct Google Drive API access via Service Account (no connector quota)
- Fallback to local sync path if SA key missing  
- Outputs index → 
- **Status**: Ready for use with Service Account key

