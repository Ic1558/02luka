# Boss Workspace Routing Rules Configuration
# File: boss/routing.rules.yml
# Purpose: Automated file routing based on content, type, and patterns
# Version: 1.0

# =============================================================================
# ROUTING RULES CONFIGURATION
# =============================================================================

rules:
  # Priority routing (checked first)
  priority:
    - name: "Critical System Alerts"
      patterns:
        - "*.alert.json"
        - "critical_*"
        - "*_emergency_*"
      content_match:
        - "priority.*critical"
        - "severity.*high"
      action: "bridge"
      priority: "high"
      notes: "Forward immediately to bridge for urgent processing"

    - name: "Security Incidents"
      patterns:
        - "security_*"
        - "*_breach_*"
        - "incident_*.json"
      content_match:
        - "security.*violation"
        - "unauthorized.*access"
      action: "bridge"
      priority: "high"
      notes: "Immediate security team notification required"

  # Content-based routing
  content_routing:
    - name: "System Metrics"
      file_types: ["json", "csv"]
      content_match:
        - "\"metrics\""
        - "\"timestamp\""
        - "\"cpu_usage\""
        - "\"memory_usage\""
      size_range:
        min: 100
        max: 10485760  # 10MB
      action: "data"
      priority: "normal"
      notes: "Process as structured metrics data"

    - name: "Configuration Files"
      file_types: ["json", "yml", "yaml", "toml"]
      content_match:
        - "\"config\""
        - "settings:"
        - "configuration"
      action: "custom"
      priority: "normal"
      notes: "Validate configuration syntax and apply changes"

    - name: "Log Analysis Reports"
      file_types: ["md", "txt"]
      content_match:
        - "# Log Analysis"
        - "## Error Summary"
        - "ERROR:"
        - "WARN:"
      action: "report"
      priority: "normal"
      notes: "Generate summary report with error categorization"

    - name: "API Response Data"
      file_types: ["json"]
      content_match:
        - "\"status\": \"success\""
        - "\"status\": \"error\""
        - "\"response\""
        - "\"api_version\""
      action: "data"
      priority: "normal"
      notes: "Parse API response and extract key metrics"

  # Pattern-based routing
  pattern_routing:
    - name: "Daily Reports"
      patterns:
        - "daily_report_*.md"
        - "*_daily_*.pdf"
        - "report_$(date +%Y%m%d)*"
      action: "report"
      priority: "normal"
      notes: "Archive with date indexing for historical reference"

    - name: "Backup Files"
      patterns:
        - "*.backup"
        - "*_backup_*"
        - "backup_*"
      action: "archive"
      priority: "low"
      notes: "Archive with retention policy applied"

    - name: "Temporary Files"
      patterns:
        - "tmp_*"
        - "*.tmp"
        - "temp_*"
      action: "archive"
      priority: "low"
      notes: "Cleanup after 24 hours"

  # File type defaults
  type_defaults:
    json:
      action: "data"
      priority: "normal"
      notes: "Parse as structured data"

    md:
      action: "report"
      priority: "normal"
      notes: "Process as documentation"

    txt:
      action: "report"
      priority: "normal"
      notes: "Process as text report"

    csv:
      action: "data"
      priority: "normal"
      notes: "Import to data processing pipeline"

    pdf:
      action: "archive"
      priority: "low"
      notes: "Store with metadata extraction"

# =============================================================================
# ROUTING ACTIONS
# =============================================================================

actions:
  report:
    description: "Generate structured analysis report"
    output_format: "markdown"
    destination: "boss/deliverables/"
    template: "report_template.md"
    processing:
      - "extract_summary"
      - "identify_key_points"
      - "generate_recommendations"

  data:
    description: "Process as structured data for AI consumption"
    output_format: "json"
    destination: "boss/deliverables/"
    template: "data_template.json"
    processing:
      - "validate_structure"
      - "normalize_fields"
      - "index_for_search"

  bridge:
    description: "Forward to bridge system for task execution"
    output_format: "markdown"
    destination: "f/bridge/inbox/"
    template: "work_order_template.md"
    processing:
      - "create_work_order"
      - "assign_priority"
      - "notify_agents"

  archive:
    description: "Store with metadata for future reference"
    output_format: "original"
    destination: "backups/boss_archive/"
    template: "archive_metadata.json"
    processing:
      - "extract_metadata"
      - "apply_retention_policy"
      - "index_for_retrieval"

  custom:
    description: "Process with custom instructions"
    output_format: "varies"
    destination: "boss/deliverables/"
    template: "custom_template.md"
    processing:
      - "parse_instructions"
      - "execute_custom_logic"
      - "generate_result"

# =============================================================================
# PRIORITY LEVELS
# =============================================================================

priorities:
  high:
    timeout: 300      # 5 minutes
    notifications: true
    escalation: true
    retry_count: 3

  normal:
    timeout: 1800     # 30 minutes
    notifications: false
    escalation: false
    retry_count: 1

  low:
    timeout: 86400    # 24 hours
    notifications: false
    escalation: false
    retry_count: 0

# =============================================================================
# VALIDATION RULES
# =============================================================================

validation:
  max_file_size: 52428800    # 50MB
  allowed_extensions:
    - "md"
    - "txt"
    - "json"
    - "csv"
    - "yml"
    - "yaml"
    - "pdf"
    - "log"

  security_checks:
    - "scan_for_credentials"
    - "check_malicious_patterns"
    - "validate_file_integrity"

  content_limits:
    max_lines: 50000
    max_chars_per_line: 10000

# =============================================================================
# EXAMPLE USAGE
# =============================================================================

# Example 1: System metrics file
# File: metrics_2025-09-30.json
# Content: {"timestamp": "2025-09-30T20:21:00Z", "cpu_usage": 75.2}
# Result: → action: "data", priority: "normal"

# Example 2: Critical alert
# File: critical_disk_space.alert.json
# Content: {"priority": "critical", "severity": "high"}
# Result: → action: "bridge", priority: "high"

# Example 3: Daily report
# File: daily_report_20250930.md
# Content: "# Daily Report\n## Summary..."
# Result: → action: "report", priority: "normal"

# Example 4: Unknown file type
# File: unknown_data.xyz
# Result: → Create query ticket for manual classification

---
# Generated by Boss Workspace System
# Documentation: See g/manuals/BOSS_ROUTING_RULES_GUIDE.md