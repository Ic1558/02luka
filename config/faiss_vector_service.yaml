# FAISS/HNSW Vector Service Configuration
# Phase 15 - Vector Search Integration
# WO-ID: WO-251107-PHASE-15-FAISS-HNSW

service:
  name: faiss_vector_service
  version: 1.0.0
  description: "FAISS/HNSW vector index service for semantic search"
  port: 8766
  host: 127.0.0.1

embedding:
  model: text-embedding-3-small
  dimension: 1536
  provider: openai

  # Fallback models (future enhancement)
  fallback_models:
    - text-embedding-ada-002

index:
  type: HNSW
  algorithm: faiss.IndexHNSWFlat

  # HNSW parameters
  hnsw:
    m: 32  # Number of connections per layer (higher = more accurate, more memory)
    ef_construction: 200  # Exploration factor during construction (higher = better quality)
    ef_search: 100  # Exploration factor during search (higher = more accurate, slower)

  # Index storage
  storage:
    index_file: ~/02luka/memory/vector_index/faiss_hnsw.index
    metadata_file: ~/02luka/memory/vector_index/metadata.jsonl
    backup_enabled: true
    backup_interval_hours: 24

search:
  default_top_k: 5
  max_top_k: 50
  default_min_score: 0.7

  # Distance metric
  metric: L2  # L2 (Euclidean), InnerProduct, or Cosine

  # Performance tuning
  batch_size: 100
  cache_enabled: true
  cache_ttl_seconds: 300

ingestion:
  batch_size: 100
  max_text_length: 8000
  chunk_size: 1200
  chunk_overlap: 200

  # Deduplication
  dedup_enabled: true
  dedup_threshold: 0.95

  # Preprocessing
  preprocessing:
    lowercase: false
    remove_special_chars: false
    normalize_unicode: true

telemetry:
  enabled: true
  schema: config/telemetry_unified.yaml
  sink: ~/02luka/g/telemetry_unified/unified.jsonl

  events:
    - faiss.index.loaded
    - faiss.index.created
    - faiss.index.saved
    - vector_query.completed
    - vector_query.error
    - ingest.completed
    - ingest.error
    - embedding.error
    - service.started
    - service.stopped

performance:
  max_concurrent_queries: 10
  query_timeout_seconds: 30
  embedding_timeout_seconds: 10

  # Resource limits
  max_memory_gb: 4
  max_index_size_gb: 2

health_check:
  endpoint: /health
  interval_seconds: 30
  timeout_seconds: 5

metadata:
  phase: "15"
  work_order: "WO-251107-PHASE-15-FAISS-HNSW"
  created: "2025-11-06"
  author: "claude"
