# Memory Consistency & Checksum Auditor Configuration
# Phase 21.2 - SOT Memory Verification

audit:
  # Audit metadata
  version: "1.0.0"
  description: "Memory consistency checker with SHA-256 checksums"

  # Source of Truth (SOT) paths
  sot:
    memory_root: "memory/cls"
    index_files:
      - "memory/cls/session_context.json"
      - "memory/cls/policies.json"
      - "memory/cls/learning_db.jsonl"
      - "memory/cls/patterns.jsonl"
      - "memory/cls/attestation_log.jsonl"
      - "memory/cls/wo_status.jsonl"

    snapshot_dirs:
      - "memory/cls/snapshots"
      - "memory/cls/attestations"

  # Checksum algorithm
  checksum:
    algorithm: "sha256"
    encoding: "hex"

  # Output configuration
  output:
    report_file: "hub/memory_audit.json"
    log_file: "g/reports/memory_audit.log"
    telemetry_file: "g/telemetry/memory_audit.jsonl"

  # Alert thresholds
  alerts:
    mismatch_threshold: 0  # Alert if mismatches > this value
    missing_file_threshold: 0
    checksum_change_threshold: 0

  # Validation rules
  validation:
    required_files:
      - "memory/cls/session_context.json"
      - "memory/cls/policies.json"

    optional_files:
      - "memory/cls/learning_db.jsonl"
      - "memory/cls/patterns.jsonl"
      - "memory/cls/attestation_log.jsonl"
      - "memory/cls/wo_status.jsonl"

    file_patterns:
      snapshots: "memory/cls/snapshots/snap_*/metadata.json"
      attestations: "memory/cls/attestations/attest_*.json"
      hash_files: "memory/cls/snapshots/snap_*/state.hash"

  # Index verification
  index:
    check_integrity: true
    verify_references: true
    check_orphans: true

# Schema definition (YAML schema in comments for documentation)
#
# Type Definitions:
# - audit.version: string (semver)
# - audit.sot.memory_root: string (relative path)
# - audit.sot.index_files: array<string>
# - audit.checksum.algorithm: enum[sha256, sha512, md5]
# - audit.output.*: string (file path)
# - audit.alerts.*: integer (threshold count)
# - audit.validation.required_files: array<string>
# - audit.validation.file_patterns.*: string (glob pattern)
# - audit.index.*: boolean
