# == 02LUKA / Phase 14.2 ==
# Classification: Strategic Integration Patch (SIP)
# Deployed by: CLS (Cognitive Local System Orchestrator)
# Maintainer: GG Core (02LUKA Automation)
# Version: v1.2-telemetry
# Revision: r1
# Phase: 14.2 – Unified SOT Telemetry Schema
# Timestamp: __AUTO__
# WO-ID: WO-251107-PHASE-14-RAG-UNIFICATION
# Verified by: CDC / CLC / GG SOT Audit Layer
# Status: Planned → Active
# Author: cls
# Identity: CLS
# Created: 2025-11-07

# Canonical unified telemetry schema (target)
canonical:
  schema_version: 1
  fields:
    classification: {type: string, required: true}
    deployed_by:   {type: string, required: true}
    maintainer:    {type: string, required: true}
    version:       {type: string, required: true}
    revision:      {type: string, required: true}
    phase:         {type: string, required: true}
    timestamp:     {type: string, required: true}
    wo_id:         {type: string, required: false}
    verified_by:   {type: string, required: true}
    status:        {type: string, required: true}
    evidence_hash: {type: string, required: false}
    component:     {type: string, required: false}
    pid:           {type: string, required: false}

# Source schemas to normalize → canonical
sources:
  cls:    # CLS event fields
    map:
      Classification: classification
      Deployed by:    deployed_by
      Maintainer:     maintainer
      Version:        version
      Revision:       revision
      Phase:          phase
      Timestamp:      timestamp
      WO-ID:          wo_id
      Verified by:    verified_by
      Status:         status
      Evidence Hash:  evidence_hash
      Component:      component
      PID:            pid
  gg:     # GG events/headers
    map:
      class:          classification
      actor:          deployed_by
      owner:          maintainer
      ver:            version
      rev:            revision
      phase:          phase
      ts:             timestamp
      wo:             wo_id
      auditors:       verified_by
      state:          status
      hash:           evidence_hash
      svc:            component
      pid:            pid
  cdc:    # Codex/CDC metadata
    map:
      classification: classification
      deployed_by:    deployed_by
      maintainer:     maintainer
      version:        version
      revision:       revision
      phase:          phase
      timestamp:      timestamp
      wo_id:          wo_id
      verified_by:    verified_by
      status:         status
      evidence_hash:  evidence_hash
      component:      component
      pid:            pid

# Normalization rules
rules:
  timestamp:
    format_in:  [iso8601, rfc3339, "%Y-%m-%d %H:%M:%S %z"]
    format_out: "%Y-%m-%d %H:%M:%S %z"
  classification:
    defaults: ["Safe Idempotent Patch (SIP) Deployment", "Strategic Integration Patch (SIP)"]
  status:
    allow: ["Planned","Active","Production ready","Closed","Complete","OK"]
    normalize:
      'OK': 'Production ready'
  revision:
    pattern: "^r[0-9]+$"
    fallback: "r1"

