{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Trading Snapshot Summary",
  "type": "object",
  "required": ["filters", "stats", "by_symbol", "by_strategy", "timeline"],
  "properties": {
    "filters": {
      "type": "object",
      "required": ["from", "to", "range_label", "generated_at"],
      "properties": {
        "from": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$"},
        "to": {"type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$"},
        "range_label": {"type": "string"},
        "market": {"type": ["string", "null"]},
        "account": {"type": ["string", "null"]},
        "symbol": {"type": ["string", "null"]},
        "generated_at": {"type": "string", "format": "date-time"}
      }
    },
    "stats": {
      "type": "object",
      "required": ["total_trades", "gross_pnl", "fees", "tax", "net_pnl", "win_rate", "avg_win", "avg_loss", "max_gain", "max_loss"],
      "properties": {
        "total_trades": {"type": "integer", "minimum": 0},
        "gross_pnl": {"type": "number"},
        "fees": {"type": "number"},
        "tax": {"type": "number"},
        "net_pnl": {"type": "number"},
        "win_rate": {"type": "number"},
        "avg_win": {"type": "number"},
        "avg_loss": {"type": "number"},
        "max_gain": {"type": "number"},
        "max_loss": {"type": "number"},
        "wins": {"type": "integer", "minimum": 0}
      }
    },
    "by_symbol": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["symbol", "trades", "net_pnl", "win_rate", "volume"],
        "properties": {
          "symbol": {"type": "string"},
          "trades": {"type": "integer", "minimum": 0},
          "net_pnl": {"type": "number"},
          "win_rate": {"type": "number"},
          "volume": {"type": "number"}
        }
      }
    },
    "by_strategy": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["strategy", "trades", "net_pnl", "win_rate"],
        "properties": {
          "strategy": {"type": "string"},
          "trades": {"type": "integer", "minimum": 0},
          "net_pnl": {"type": "number"},
          "win_rate": {"type": "number"}
        }
      }
    },
    "timeline": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["time_bucket", "trades", "net_pnl"],
        "properties": {
          "time_bucket": {"type": "string"},
          "trades": {"type": "integer", "minimum": 0},
          "net_pnl": {"type": "number"}
        }
      }
    }
  }
}
